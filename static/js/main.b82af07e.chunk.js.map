{"version":3,"sources":["CodeTextArea/CodeTextArea.tsx","ProseMirror/ProseMirror.tsx","ViewSwitcher/ViewSwitcher.tsx","../../common/dist/languages/RichLanguageFormat.js","../../common/dist/utils/ProseMirrorUtils.js","../../common/dist/tools/StandardToolOptions.js","../../common/dist/tools/StandardTools.js","../../language-markdown/dist/inline_styles/InlineStylesMark.js","../../language-markdown/dist/utils/MarkUtils.js","../../language-markdown/dist/inline_styles/InlineStylesTool.js","../../language-markdown/dist/inline_styles/InlineStylesToMarkdown.js","../../language-markdown/dist/markdown/MarkdownParser.js","../../language-markdown/dist/markdown/MarkdownSerializer.js","../../language-markdown/dist/schema/createSchema.js","../../language-markdown/dist/MarkdownLanguage.js","../../language-markdown/dist/MarkdownLanguageConfiguration.js","../../language-markdown/dist/index.js","ProseMirrorToolbar/ProseMirrorToolbarContext.ts","ProseMirrorToolbarIconButton/ProseMirrorToolbarIconButton.tsx","ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown.tsx","ProseMirrorToolbarGroup/ProseMirrorToolbarGroup.tsx","ProseMirrorToolbar/ProseMirrorToolbar.tsx","RichTextEditor/DefaultToolbar.ts","HyperlinkDialog/HyperlinkDialog.tsx","ImageDialog/ImageDialog.tsx","RichTextDialogs/RichTextDialogsContext.ts","RichTextDialogs/RichTextDialogsContainer.tsx","RichTextEditor/RichTextEditor.tsx","ProseMirrorToolbar/ProseMirrorToolbarState.ts","../../prosemirror-dynamic-content/dist/InlineChooser/InlineChooser.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkView.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkView.js","../../prosemirror-dynamic-content/dist/DynamicContentTools/DynamicContentTools.js","../../language-json/dist/blocks/DcContentLinkBlock.js","../../language-json/dist/blocks/DcImageLinkBlock.js","../../language-json/dist/blocks/MarkdownBlock.js","../../language-json/dist/schema/createSchema.js","../../language-json/dist/JSONLanguage.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkNode.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkNode.js","../../language-json/dist/JSONLanguageConfiguration.js","EditorRichTextField/EditorRichTextField.tsx","../../language-json/dist/index.js","App.tsx","index.tsx"],"names":["withStyles","root","flex","display","minHeight","maxHeight","textarea","outline","resize","backgroundColor","border","padding","fontFamily","fontSize","props","classes","value","onChange","readOnly","handleChange","React","useCallback","event","target","className","EditorView","EditorState","require","exampleSetup","ProseMirror","ref","createRef","state","this","schema","doc","create","plugins","menuBar","parent","onUpdateState","editorState","createEditorState","view","editorViewOptions","dispatchTransaction","transaction","applyTransaction","transactions","updateState","some","tr","docChanged","forceUpdate","editorView","createEditorView","current","setState","Component","width","overflowY","RichLanguageFormat","button","transition","height","cursor","background","borderTop","borderBottom","color","fontWeight","selected","borderBottomColor","language","disableCodeView","disableEditView","useState","CODE","EDIT","selectedView","setSelectedView","renderButton","label","onClick","clsx","type","role","isMarkActive","_a","selection","from","$from","to","empty","isInSet","storedMarks","marks","rangeHasMark","isToolEnabled","toolName","options","tools","blacklist","indexOf","whitelist","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","undoFn","undo","redoFn","redo","toggleMark","setBlockType","wrapInList","createMarkToggleTool","name","icon","displayIcon","isActive","editLink","dialog","_this","dispatch","linkValue","href","title","undefined","insertImage","imageValue","replaceSelectionWith","createAndFill","src","alt","heading","level","command","nodes","displayLabel","createElement","style","margin","isEnabled","createStandardTools","strong","em","code","link","dialogs","getHyperlink","bullet_list","ordered_list","image","getImage","blockquote","i","paragraph","code_block","horizontal_rule","d","depth","index","node","canReplaceWith","canInsert","$cursor","ranges","_i","marks_1","mark","removeStoredMark","ranges_1","range","_b","_c","Object","keys","markName","removeMark","pos","$to","__assign","assign","s","arguments","p","prototype","hasOwnProperty","inline_styles","attrs","class","default","group","parseDOM","tag","getAttrs","getAttribute","attributes","toDOM","getMarkFromRange","markType","nodesBetween","find","x","mergeAttrs","oldAttrs","newAttrs","inlineStyleClassNameTool","classLabel","existingMark","getStoredMark","addStoredMark","has","ref$1","ref$2","$from$1","$to$1","markAttrs","addMark","scrollIntoView","filter","found","rangeHasFilteredMark","isFilteredMarkActive","m","InlineStylesToMarkdown","open","attrsSerialized","map","key","join","close","markdown","markdownit","Schema","createSchema","isInlineStylesEnabled","spec","addToEnd","MarkdownLanguage","concat","inlineStylesOptions","classNames","createInlineStylesTools","serializer","MarkdownSerializer","defaultMarkdownSerializer","createMarkdownSerializer","parser","defaultMarkdownParser","MarkdownParser","html","tokens","tokenHandlers","html_inline","token","content","trim","startsWith","endsWith","DOMParser","parseFromString","firstChild","nodeName","toLowerCase","openMark","closeMark","html_block","createMarkdownParser","serialize","parse","data","format","TEXT","conf","MarkdownLanguageConfiguration","ProseMirrorToolbarContext","createContext","ProseMirrorToolbarIconButton","useContext","getToolState","applyTool","toolState","handleClick","IconButton","size","disabled","enabled","active","paddingLeft","paddingRight","toolNames","toolStates","renderValue","cloneElement","Select","displayEmpty","MenuItem","divider","verticalAlign","lineHeight","borderRight","children","layout","toolbarState","Provider","tool","disableGutters","renderToolbarElement","element","child","HyperlinkDialog","onClose","onSubmit","setValue","isValid","setIsValid","handleInputChanged","fieldValue","newValue","validateUrl","reset","handleCancel","handleSubmit","Dialog","maxWidth","fullWidth","aria-labelledby","DialogTitle","id","DialogContent","FormControl","TextField","autoFocus","required","FormHelperText","DialogActions","Button","ImageDialog","context","RichTextDialogsContainer","openDialog","setOpenDialog","handleCloseDialog","handleSubmitDialog","handleOpenDialog","sdk","SdkContext","getDcImageLink","mediaLink","getDcContentLink","contentTypeIds","contentLink","get","RichTextDialogsContext","frame","flexDirection","borderRadius","languagesProp","languages","languageProp","toolbarLayoutProp","toolbarLayout","disableToolbar","readOnlyCodeView","valueProp","Error","languageConfiguration","setView","JSON","stringify","rawValue","setRawValue","proseMirrorDocument","setProseMirrorDocument","handleRawValueChange","err","newProseMirrorDocument","handleEditorChange","newRawValue","setToolbarState","DefaultToolbar","handleEditorUpdateState","visible","isVisible","computeToolbarState","__rest","getOwnPropertySymbols","propertyIsEnumerable","position","variant","aspectRatio","other","aspectRatioPaddingTop","useMemo","components","split","Math","round","Number","Fragment","paddingTop","ViewComponent","loading","broken","invalid","statusIcons","top","left","right","bottom","alignItems","alignContent","justifyContent","onDelete","setBroken","setLoading","handleLoading","handleError","handleLoaded","hasValidValue","endpoint","Fab","dynamicContent","stagingEnvironment","defaultHost","encodeURIComponent","onLoadStart","onError","onLoad","CircularProgress","DcImageLinkView","getPos","dom","document","handleDelete","bind","render","start","delete","nodeSize","boxShadow","backgroundSize","backgroundRepeat","backgroundPosition","contentType","contentLinkOptions","customIcon","contentTypeSettings","cardTemplateUrl","aspectRatios","schemaId","getContentTypeAspectRatio","backgroundImage","template","params","contentItemId","DcContentLinkView","createDynamicContentTools","contentTypes","Node","DcContentLinkBlock","canSerialize","canParse","block","blocks","forEach","DcImageLinkBlock","MarkdownBlock","parsedNodes","fromJSON","toJSON","__spreadArrays","il","r","Array","k","a","j","jl","JSONLanguage","blockTypes","addBefore","defining","draggable","atom","nodesByConverter","groupBy","blockType","nodesByConverter_1","groupBlocks","items","blocksGroupedByConverter","blocksGroupedByConverter_1","groupFn","currentGroup","currentGroupItems","items_1","item","itemGroup","toolOptions","settings","json","JSONLanguageConfiguration","nodeViews","styles","dangerouslySetInnerHTML","__html","stylesheet","rel","toolbar","codeView","App","connected","handleValueChange","handleChooseLink","handleConnect","init","startAutoResizer","field","getValue","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.b82af07e.chunk.js","sourcesContent":["import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\n\nconst styles = {\n  root: {\n    flex: 1,\n    display: \"flex\",\n    minHeight: 286,\n    maxHeight: 500\n  },\n  textarea: {\n    flex: 1,\n    outline: \"none\" as \"none\",\n    resize: \"none\" as \"none\",\n    backgroundColor: \"#f0f0f0\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    padding: \"10px 8px 0\",\n    fontFamily: \"roboto,sans-serif!important\",\n    fontSize: 13\n  }\n};\n\nexport interface CodeTextAreaProps extends WithStyles<typeof styles> {\n  readOnly?: boolean;\n  value: string;\n  onChange?: (value: string) => void;\n}\n\nconst CodeTextArea: React.SFC<CodeTextAreaProps> = (\n  props: CodeTextAreaProps\n) => {\n  const { classes, value, onChange, readOnly = false } = props;\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      if (onChange) {\n        onChange(event.target.value);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      <textarea\n        readOnly={readOnly}\n        className={classes.textarea}\n        value={value}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(CodeTextArea);\n","import React, { RefObject } from \"react\";\n\nimport \"./ProseMirror.scss\";\n\nimport { WithStyles, withStyles } from \"@material-ui/core\";\n\n// tslint:disable-next-line\nconst EditorState = require(\"prosemirror-state\").EditorState;\n// tslint:disable-next-line\nconst EditorView = require(\"prosemirror-view\").EditorView;\n// tslint:disable-next-line\nconst exampleSetup = require(\"prosemirror-example-setup\").exampleSetup;\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    minHeight: 250,\n    maxHeight: 600,\n    overflowY: \"scroll\" as \"scroll\"\n  }\n};\n\nexport interface ProseMirrorProps extends WithStyles<typeof styles> {\n  schema: any;\n  doc?: any;\n  editorViewOptions?: any;\n  onUpdateState?: (state: any, editorView: any) => void;\n  onChange?: (doc: any) => void;\n}\n\ninterface ProseMirrorState {\n  ref: RefObject<any>;\n  editorView?: any;\n}\n\nclass ProseMirror extends React.Component<ProseMirrorProps, ProseMirrorState> {\n  constructor(props: ProseMirrorProps) {\n    super(props);\n    const ref = React.createRef();\n    this.state = { ref };\n  }\n\n  public createEditorState(): any {\n    const { schema, doc } = this.props;\n\n    return EditorState.create({\n      schema,\n      doc,\n      plugins: exampleSetup({ schema, menuBar: false })\n    });\n  }\n\n  public createEditorView(parent: any): any {\n    const { onUpdateState, onChange } = this.props;\n\n    const editorState = this.createEditorState();\n\n    const view = new EditorView(parent, {\n      ...this.props.editorViewOptions,\n      state: editorState,\n      dispatchTransaction: (transaction: any) => {\n        const { state, transactions } = view.state.applyTransaction(\n          transaction\n        );\n        view.updateState(state);\n\n        if (onUpdateState) {\n          onUpdateState(state, view);\n        }\n\n        if (transactions.some((tr: any) => tr.docChanged)) {\n          if (onChange) {\n            onChange(state.doc);\n          }\n        }\n\n        this.forceUpdate();\n      }\n    });\n\n    if (onUpdateState) {\n      onUpdateState(view.state, view);\n    }\n\n    return view;\n  }\n\n  public componentDidMount(): void {\n    if (this.state.ref && !this.state.editorView) {\n      const editorView = this.createEditorView(this.state.ref.current);\n      this.setState({ editorView });\n    }\n  }\n\n  public render(): React.ReactElement {\n    const { classes } = this.props;\n    return <div className={classes.root} ref={this.state.ref} />;\n  }\n}\n\nexport default withStyles(styles)(ProseMirror);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\n\nconst styles = {\n  root: {\n    display: \"flex\"\n  },\n  button: {\n    outline: \"none\" as \"none\",\n    transition: \"color 0.2s linear,border-bottom-color 0.2s linear\",\n    height: 40,\n    cursor: \"pointer\" as \"pointer\",\n    background: \"transparent\" as \"transparent\",\n    border: \"0 solid transparent\",\n    borderTop: \"3px solid transparent\",\n    borderBottom: \"3px solid transparent\",\n    fontSize: 13,\n    padding: \"0 15px\",\n    color: \"#999999\",\n    fontWeight: \"bold\" as \"bold\"\n  },\n  selected: {\n    color: \"#1EA7FD\",\n    borderBottomColor: \"#1EA7FD\"\n  }\n};\n\nexport interface ViewSwitcherProps extends WithStyles<typeof styles> {\n  disableCodeView?: boolean;\n  disableEditView?: boolean;\n\n  language?: string;\n  onChange?: (view: EditorView) => void;\n}\n\nexport enum EditorView {\n  EDIT = \"edit\",\n  CODE = \"code\"\n}\n\nconst ViewSwitcher = (props: ViewSwitcherProps) => {\n  const {\n    classes,\n    onChange,\n    language,\n    disableCodeView,\n    disableEditView\n  } = props;\n\n  const [selectedView, setSelectedView] = React.useState(\n    !disableEditView ? EditorView.EDIT : EditorView.CODE\n  );\n\n  const handleChange = React.useCallback(\n    (view: EditorView) => {\n      setSelectedView(view);\n      if (onChange) {\n        onChange(view);\n      }\n    },\n    [setSelectedView]\n  );\n\n  const renderButton = React.useCallback(\n    (label: string, view: EditorView) => {\n      return (\n        <button\n          onClick={() => handleChange(view)}\n          className={clsx(classes.button, {\n            [classes.selected]: selectedView === view\n          })}\n          type=\"button\"\n          role=\"tab\"\n        >\n          {label}\n        </button>\n      );\n    },\n    [selectedView, handleChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      {disableEditView ? false : renderButton(\"Edit\", EditorView.EDIT)}\n      {disableCodeView\n        ? false\n        : renderButton(language || \"Code\", EditorView.CODE)}\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ViewSwitcher);\n","export var RichLanguageFormat;\n\n(function (RichLanguageFormat) {\n  RichLanguageFormat[\"TEXT\"] = \"text\";\n  RichLanguageFormat[\"JSON\"] = \"json\";\n})(RichLanguageFormat || (RichLanguageFormat = {}));","export function isMarkActive(state, type) {\n  var _a = state.selection,\n      from = _a.from,\n      $from = _a.$from,\n      to = _a.to,\n      empty = _a.empty;\n\n  if (empty) {\n    return type.isInSet(state.storedMarks || $from.marks());\n  } else {\n    return state.doc.rangeHasMark(from, to, type);\n  }\n}\nexport function getSelectionMarks(state) {\n  var _a = state.selection,\n      $from = _a.$from,\n      $to = _a.$to;\n  var currentMarks = [];\n  state.doc.nodesBetween($from.pos, $to.pos, function (node) {\n    node.marks.forEach(function (mark) {\n      return currentMarks.push(mark);\n    });\n  });\n  return currentMarks;\n}\nexport function hasMarkup(state, type, atts) {\n  var _a = state.selection,\n      $from = _a.$from,\n      to = _a.to,\n      node = _a.node;\n\n  if (node) {\n    return node.hasMarkup(type, atts);\n  }\n\n  return to <= $from.end() && $from.parent.hasMarkup(type, atts);\n}\nexport function canInsert(state, type) {\n  var $from = state.selection.$from;\n\n  for (var d = $from.depth; d >= 0; d--) {\n    var index = $from.index(d);\n\n    if ($from.node(d).canReplaceWith(index, index, type)) {\n      return true;\n    }\n  }\n\n  return false;\n}\nexport function clearAllMarks() {\n  return function (state, dispatch) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n\n    if (dispatch) {\n      if ($cursor) {\n        var marks = state.storedMarks || $cursor.marks();\n\n        for (var _i = 0, marks_1 = marks; _i < marks_1.length; _i++) {\n          var mark = marks_1[_i];\n          dispatch(state.tr.removeStoredMark(mark.type));\n        }\n      } else {\n        var tr = state.tr;\n\n        for (var _a = 0, ranges_1 = ranges; _a < ranges_1.length; _a++) {\n          var range = ranges_1[_a];\n\n          for (var _b = 0, _c = Object.keys(state.schema.marks); _b < _c.length; _b++) {\n            var markName = _c[_b];\n            tr.removeMark(range.$from.pos, range.$to.pos, state.schema.marks[markName]);\n          }\n        }\n\n        dispatch(tr);\n      }\n    }\n\n    return true;\n  };\n}","export function isToolEnabled(toolName, options) {\n  if (options.tools && options.tools.blacklist && options.tools.blacklist.indexOf(toolName) !== -1) {\n    return false;\n  }\n\n  if (options.tools && options.tools.whitelist && options.tools.whitelist.indexOf(toolName) === -1) {\n    return false;\n  }\n\n  return true;\n}","var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport React from \"react\";\nimport { canInsert, clearAllMarks, isMarkActive } from \"../utils\"; // tslint:disable:no-submodule-imports\n\nimport CalendarViewDay from \"@material-ui/icons/CalendarViewDay\";\nimport Code from \"@material-ui/icons/Code\";\nimport FormatBold from \"@material-ui/icons/FormatBold\";\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\nimport FormatItalic from \"@material-ui/icons/FormatItalic\";\nimport FormatListBulleted from \"@material-ui/icons/FormatListBulleted\";\nimport FormatListNumbered from \"@material-ui/icons/FormatListNumbered\";\nimport FormatQuote from \"@material-ui/icons/FormatQuote\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport Link from \"@material-ui/icons/Link\";\nimport Redo from \"@material-ui/icons/Redo\";\nimport Undo from \"@material-ui/icons/Undo\";\nimport { isToolEnabled } from \"./StandardToolOptions\"; // tslint:disable-next-line\n\nvar _a = require(\"prosemirror-history\"),\n    undoFn = _a.undo,\n    redoFn = _a.redo; // tslint:disable-next-line\n\n\nvar _b = require(\"prosemirror-commands\"),\n    toggleMark = _b.toggleMark,\n    setBlockType = _b.setBlockType; // tslint:disable-next-line\n\n\nvar wrapInList = require(\"prosemirror-schema-list\").wrapInList;\n\nexport function createMarkToggleTool(name, label, icon, type) {\n  return {\n    name: name,\n    label: label,\n    displayIcon: icon,\n    isActive: function isActive(state) {\n      return isMarkActive(state, type);\n    },\n    apply: toggleMark(type)\n  };\n}\nexport function undo() {\n  return {\n    name: \"undo\",\n    label: \"Undo\",\n    displayIcon: React.createElement(Undo, null),\n    isEnabled: function isEnabled(state) {\n      return undoFn(state);\n    },\n    apply: undoFn\n  };\n}\nexport function redo() {\n  return {\n    name: \"redo\",\n    label: \"Redo\",\n    displayIcon: React.createElement(Redo, null),\n    isEnabled: function isEnabled(state) {\n      return redoFn(state);\n    },\n    apply: redoFn\n  };\n}\nexport function strong(schema) {\n  return createMarkToggleTool(\"strong\", \"Bold\", React.createElement(FormatBold, null), schema.marks.strong);\n}\nexport function em(schema) {\n  return createMarkToggleTool(\"em\", \"Italic\", React.createElement(FormatItalic, null), schema.marks.em);\n}\nexport function code(schema) {\n  return createMarkToggleTool(\"code\", \"Code\", React.createElement(Code, null), schema.marks.code);\n}\nexport function editLink(type, dialog) {\n  var _this = this;\n\n  return function (state, dispatch, view) {\n    return __awaiter(_this, void 0, void 0, function () {\n      var linkValue, err_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (isMarkActive(state, type)) {\n              toggleMark(type)(state, dispatch, view);\n              return [2\n              /*return*/\n              ];\n            }\n\n            if (!dialog) return [3\n            /*break*/\n            , 4];\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , dialog()];\n\n          case 2:\n            linkValue = _a.sent();\n            toggleMark(type, {\n              href: linkValue.href,\n              title: linkValue.title === \"\" ? undefined : linkValue.title\n            })(state, dispatch, view);\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            err_1 = _a.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 4:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n}\nexport function link(schema, dialog) {\n  return {\n    name: \"link\",\n    label: \"Add or remove Link\",\n    displayIcon: React.createElement(Link, null),\n    isActive: function isActive(state) {\n      return isMarkActive(state, schema.marks.link);\n    },\n    isEnabled: function isEnabled(state) {\n      return !state.selection.empty;\n    },\n    apply: editLink(schema.marks.link, dialog)\n  };\n}\nexport function insertImage(type, dialog) {\n  var _this = this;\n\n  return function (state, dispatch, view) {\n    return __awaiter(_this, void 0, void 0, function () {\n      var imageValue, err_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!dialog) return [3\n            /*break*/\n            , 4];\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , dialog()];\n\n          case 2:\n            imageValue = _a.sent();\n            view.dispatch(view.state.tr.replaceSelectionWith(type.createAndFill({\n              src: imageValue.src,\n              title: imageValue.title === \"\" ? undefined : imageValue.title,\n              alt: imageValue.alt === \"\" ? undefined : imageValue.alt\n            })));\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            err_2 = _a.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 4:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n}\nexport function image(schema, dialog) {\n  return {\n    name: \"image\",\n    label: \"Insert Image from URL\",\n    displayIcon: React.createElement(ImageIcon, null),\n    apply: insertImage(schema.nodes.image, dialog)\n  };\n}\nexport function bullet_list(schema) {\n  return {\n    name: \"bullet_list\",\n    label: \"Bullet List\",\n    displayIcon: React.createElement(FormatListBulleted, null),\n    apply: wrapInList(schema.nodes.bullet_list, {})\n  };\n}\nexport function ordered_list(schema) {\n  return {\n    name: \"ordered_list\",\n    label: \"Ordered List\",\n    displayIcon: React.createElement(FormatListNumbered, null),\n    apply: wrapInList(schema.nodes.ordered_list, {})\n  };\n}\nexport function blockquote(schema) {\n  return {\n    name: \"blockquote\",\n    label: \"Quote\",\n    displayIcon: React.createElement(FormatQuote, null),\n    apply: wrapInList(schema.nodes.blockquote, {})\n  };\n}\nexport function heading(schema, level) {\n  var command = setBlockType(schema.nodes.heading, {\n    level: level\n  });\n  return {\n    name: \"heading_\" + level,\n    label: \"Heading \" + level,\n    displayLabel: React.createElement(\"h\" + level, {\n      style: {\n        margin: 0\n      }\n    }, \"Heading \" + level),\n    apply: command,\n    isEnabled: function isEnabled(state) {\n      return command(state);\n    },\n    isActive: function isActive(state, view) {\n      return !command(state, null, view);\n    }\n  };\n}\nexport function paragraph(schema) {\n  var command = setBlockType(schema.nodes.paragraph);\n  return {\n    name: \"paragraph\",\n    label: \"Normal text\",\n    displayLabel: React.createElement(\"p\", {\n      style: {\n        margin: 0,\n        padding: 0,\n        display: \"inline\"\n      }\n    }, \"Normal text\"),\n    apply: command,\n    isEnabled: function isEnabled(state) {\n      return command(state);\n    },\n    isActive: function isActive(state, view) {\n      return !command(state, null, view);\n    }\n  };\n}\nexport function code_block(schema) {\n  var command = setBlockType(schema.nodes.code_block);\n  return {\n    name: \"code_block\",\n    label: \"Code Block\",\n    displayLabel: React.createElement(\"code\", null, \"Code Block\"),\n    displayIcon: React.createElement(Code, null),\n    apply: command,\n    isEnabled: function isEnabled(state) {\n      return command(state);\n    },\n    isActive: function isActive(state, view) {\n      return !command(state, null, view);\n    }\n  };\n}\nexport function horizontal_rule(schema) {\n  return {\n    name: \"horizontal_rule\",\n    label: \"Insert Horizontal Rule\",\n    displayIcon: React.createElement(CalendarViewDay, null),\n    apply: function apply(state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\n    },\n    isEnabled: function isEnabled(state) {\n      return canInsert(state, schema.nodes.horizontal_rule);\n    }\n  };\n}\nexport function clear_formatting() {\n  return {\n    name: \"clear_formatting\",\n    label: \"Clear Formatting\",\n    displayIcon: React.createElement(FormatClearIcon, null),\n    apply: clearAllMarks(),\n    isEnabled: function isEnabled(state) {\n      // are there any marks?\n      return true;\n    }\n  };\n}\nexport function createStandardTools(schema, options) {\n  var tools = [];\n\n  if (isToolEnabled('undo', options)) {\n    tools.push(undo());\n  }\n\n  if (isToolEnabled('redo', options)) {\n    tools.push(redo());\n  }\n\n  if (isToolEnabled('strong', options) && schema.marks.strong) {\n    tools.push(strong(schema));\n  }\n\n  if (isToolEnabled('em', options) && schema.marks.em) {\n    tools.push(em(schema));\n  }\n\n  if (isToolEnabled('code', options) && schema.marks.code) {\n    tools.push(code(schema));\n  }\n\n  if (isToolEnabled('link', options) && schema.marks.link) {\n    tools.push(link(schema, options.dialogs ? options.dialogs.getHyperlink : undefined));\n  }\n\n  if (isToolEnabled('bullet_list', options) && schema.nodes.bullet_list) {\n    tools.push(bullet_list(schema));\n  }\n\n  if (isToolEnabled('ordered_list', options) && schema.nodes.ordered_list) {\n    tools.push(ordered_list(schema));\n  }\n\n  if (isToolEnabled('image', options) && schema.nodes.image) {\n    tools.push(image(schema, options.dialogs ? options.dialogs.getImage : undefined));\n  }\n\n  if (isToolEnabled('blockquote', options) && schema.nodes.blockquote) {\n    tools.push(blockquote(schema));\n  }\n\n  if (isToolEnabled('heading', options) && schema.nodes.heading) {\n    for (var i = 1; i < 7; i++) {\n      tools.push(heading(schema, i));\n    }\n  }\n\n  if (isToolEnabled('paragraph', options) && schema.nodes.paragraph) {\n    tools.push(paragraph(schema));\n  }\n\n  if (isToolEnabled('code_block', options) && schema.nodes.code_block) {\n    tools.push(code_block(schema));\n  }\n\n  if (isToolEnabled('horizontal_rule', options) && schema.nodes.horizontal_rule) {\n    tools.push(horizontal_rule(schema));\n  }\n\n  if (isToolEnabled('clear_formatting', options)) {\n    tools.push(clear_formatting());\n  }\n\n  return tools;\n}","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n}; // tslint:disable-next-line\n\n\nexport var inline_styles = {\n  attrs: {\n    class: {\n      default: \"\"\n    },\n    style: {\n      default: \"\"\n    }\n  },\n  group: \"inline\",\n  parseDOM: [{\n    tag: \"span\",\n    getAttrs: function getAttrs(node) {\n      return {\n        class: node.getAttribute(\"class\"),\n        style: node.attributes.style.value\n      };\n    }\n  }],\n  toDOM: function toDOM(mark) {\n    return [\"span\", __assign(__assign({}, mark.attrs.style ? {\n      style: mark.attrs.style\n    } : {}), {\n      class: mark && mark.attrs && mark.attrs.class ? mark.attrs.class : \"\"\n    }), 0];\n  }\n};","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction rangeHasFilteredMark(doc, from, to, type, filter) {\n  var found = false;\n\n  if (to > from) {\n    doc.nodesBetween(from, to, function (node) {\n      if (type.isInSet(node.marks) && node.marks.filter(filter).length > 0) {\n        found = true;\n      }\n\n      return !found;\n    });\n  }\n\n  return found;\n}\n\nexport function isFilteredMarkActive(state, type, filter) {\n  var _a = state.selection,\n      from = _a.from,\n      $from = _a.$from,\n      to = _a.to,\n      empty = _a.empty;\n\n  if (empty) {\n    if (!type.isInSet(state.storedMarks || $from.marks())) {\n      return false;\n    }\n\n    var validMarks = (state.storedMarks || $from.marks()).filter(filter);\n    return validMarks.length > 0;\n  } else {\n    return rangeHasFilteredMark(state.doc, from, to, type, filter);\n  }\n}\n\nfunction getMarkFromRange(state, from, to, markType) {\n  var result;\n\n  if (to > from) {\n    state.doc.nodesBetween(from, to, function (node) {\n      if (markType.isInSet(node.marks)) {\n        result = node.marks.find(function (x) {\n          return x.type === markType;\n        });\n        return false;\n      }\n\n      return true;\n    });\n  }\n\n  return result;\n}\n\nfunction getStoredMark(state, markType) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n\n  if ($cursor) {\n    return (state.storedMarks || $cursor.marks()).find(function (x) {\n      return x.type === markType;\n    });\n  }\n}\n\nfunction mergeAttrs(oldAttrs, newAttrs) {\n  return __assign(__assign({}, oldAttrs), newAttrs);\n}\n\nexport function setMarkAttributes(markType, attrs) {\n  return function (state, dispatch) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks())) {\n          var existingMark = getStoredMark(state, markType);\n          dispatch(state.tr.removeStoredMark(markType));\n\n          if (existingMark) {\n            dispatch(state.tr.addStoredMark(markType.create(mergeAttrs(existingMark.attrs, attrs))));\n          }\n        } else {\n          dispatch(state.tr.addStoredMark(markType.create(attrs)));\n        }\n      } else {\n        var has = false;\n        var tr = state.tr;\n\n        for (var i = 0; !has && i < ranges.length; i++) {\n          var ref$1 = ranges[i];\n          var $from = ref$1.$from;\n          var $to = ref$1.$to;\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n        }\n\n        for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\n          var ref$2 = ranges_1[_i];\n          var $from$1 = ref$2.$from;\n          var $to$1 = ref$2.$to;\n\n          if (has) {\n            var markAttrs = __assign({}, getMarkFromRange(state, $from$1.pos, $to$1.pos, markType).attrs);\n\n            tr.removeMark($from$1.pos, $to$1.pos, markType);\n            tr.addMark($from$1.pos, $to$1.pos, markType.create(mergeAttrs(markAttrs, attrs)));\n          } else {\n            tr.addMark($from$1.pos, $to$1.pos, markType.create(attrs));\n          }\n        }\n\n        dispatch(tr.scrollIntoView());\n      }\n    }\n\n    return true;\n  };\n}","import { isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport React from 'react';\nimport { isFilteredMarkActive, setMarkAttributes } from \"../utils/MarkUtils\";\nexport function inlineStyleClassNameTool(schema, className, classLabel) {\n  var mark = schema.marks.inline_styles;\n  return {\n    name: \"inline_styles_className_\" + className,\n    label: classLabel,\n    displayLabel: React.createElement(\"span\", {\n      className: className\n    }, classLabel),\n    apply: setMarkAttributes(mark, {\n      class: className\n    }),\n    isEnabled: function isEnabled(state) {\n      return true;\n    },\n    isActive: function isActive(state) {\n      return isFilteredMarkActive(state, mark, function (m) {\n        return m.attrs.class === className;\n      });\n    }\n  };\n}\nexport function createInlineStylesTools(schema, options) {\n  var tools = [];\n\n  if (schema.marks.inline_styles && isToolEnabled('inline_styles', options) && options.tools && options.tools.inline_styles) {\n    var inlineStylesOptions = options.tools.inline_styles;\n\n    if (inlineStylesOptions.classNames) {\n      for (var _i = 0, _a = inlineStylesOptions.classNames; _i < _a.length; _i++) {\n        var className = _a[_i];\n        tools.push(inlineStyleClassNameTool(schema, className.className, className.label));\n      }\n    }\n  }\n\n  return tools;\n}","export var InlineStylesToMarkdown = {\n  inline_styles: {\n    open: function open(state, mark, parent, index) {\n      var attrs = {};\n\n      if (mark.attrs.class) {\n        attrs.class = mark.attrs.class;\n      }\n\n      var attrsSerialized = Object.keys(attrs).map(function (key) {\n        return key + \"=\\\"\" + attrs[key] + \"\\\"\";\n      }).join(\" \");\n\n      if (attrsSerialized.length > 0) {\n        return \"<span \" + attrsSerialized + \">\";\n      } else {\n        return \"<span>\";\n      }\n    },\n    close: \"</span>\"\n  }\n};","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n}; // tslint:disable-next-line\n\n\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar markdownit = require(\"markdown-it\");\n\nexport function createMarkdownParser(schema, isInlineStylesEnabled) {\n  if (isInlineStylesEnabled === void 0) {\n    isInlineStylesEnabled = false;\n  }\n\n  if (!isInlineStylesEnabled) {\n    return markdown.defaultMarkdownParser;\n  } // Patch parser to detect <span></span> tags and convert into inline_styles marks\n  // Warning... this might be a little brittle\n\n\n  var parser = new markdown.MarkdownParser(schema, markdownit(\"commonmark\", {\n    html: true\n  }), __assign({}, markdown.defaultMarkdownParser.tokens));\n\n  parser.tokenHandlers.html_inline = function (state, token) {\n    if (!token || !token.content) {\n      return;\n    }\n\n    var content = (token.content || \"\").trim();\n\n    if (content.startsWith(\"<span\") && content.endsWith(\">\")) {\n      var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n      var tag = dom.body.firstChild;\n\n      if (!tag) {\n        return;\n      }\n\n      if (tag.nodeName.toLowerCase() === \"span\") {\n        var className = tag.getAttribute(\"class\");\n        state.openMark(schema.marks.inline_styles.create({\n          class: className\n        }));\n      }\n    } else if (content === \"</span>\") {\n      state.closeMark(schema.marks.inline_styles);\n    }\n  }; // tslint:disable-next-line\n\n\n  parser.tokenHandlers.html_block = function () {};\n\n  return parser;\n}","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { InlineStylesToMarkdown } from \"../inline_styles\"; // tslint:disable-next-line\n\nvar markdown = require(\"prosemirror-markdown\");\n\nexport function createMarkdownSerializer(isInlineStylesEnabled) {\n  if (isInlineStylesEnabled === void 0) {\n    isInlineStylesEnabled = false;\n  }\n\n  return !isInlineStylesEnabled ? markdown.defaultMarkdownSerializer : new markdown.MarkdownSerializer(markdown.defaultMarkdownSerializer.nodes, __assign(__assign({}, markdown.defaultMarkdownSerializer.marks), InlineStylesToMarkdown));\n}","import { inline_styles } from \"../inline_styles\"; // tslint:disable-next-line\n\nvar Schema = require(\"prosemirror-model\").Schema;\n\nexport function createSchema(isInlineStylesEnabled) {\n  if (isInlineStylesEnabled === void 0) {\n    isInlineStylesEnabled = false;\n  }\n\n  var schema = require(\"prosemirror-markdown\").schema; // TODO: don't register nodes and marks that are disabled in the options\n\n\n  var marks = schema.spec.marks;\n\n  if (isInlineStylesEnabled) {\n    marks = marks.addToEnd(\"inline_styles\", inline_styles);\n  }\n\n  return new Schema({\n    nodes: schema.spec.nodes,\n    marks: marks\n  });\n}","import { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { createInlineStylesTools } from \"./inline_styles\";\nimport { createMarkdownParser } from \"./markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"./markdown/MarkdownSerializer\";\nimport { createSchema } from \"./schema/createSchema\";\n\nvar MarkdownLanguage =\n/** @class */\nfunction () {\n  function MarkdownLanguage(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.name = \"markdown\";\n    this.label = \"Markdown\";\n    var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\n    var schema = createSchema(isInlineStylesEnabled);\n    var tools = createStandardTools(schema, options);\n\n    if (isInlineStylesEnabled) {\n      tools = tools.concat(tools, createInlineStylesTools(schema, options));\n    }\n\n    var serializer = createMarkdownSerializer(isInlineStylesEnabled);\n    var parser = createMarkdownParser(schema, isInlineStylesEnabled);\n    this.schema = schema;\n    this.tools = tools;\n    this.serializer = serializer;\n    this.parser = parser;\n  }\n\n  MarkdownLanguage.prototype.serialize = function (doc) {\n    return this.serializer.serialize(doc);\n  };\n\n  MarkdownLanguage.prototype.parse = function (data) {\n    if (!data) {\n      data = \"\";\n    }\n\n    return this.parser.parse(data);\n  };\n\n  return MarkdownLanguage;\n}();\n\nexport default MarkdownLanguage;","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n  format: RichLanguageFormat.TEXT\n};\nexport default conf;","import MarkdownLanguage from \"./MarkdownLanguage\";\nimport MarkdownLanguageConfiguration from \"./MarkdownLanguageConfiguration\";\nexport default function (options) {\n  return {\n    language: new MarkdownLanguage(options),\n    conf: MarkdownLanguageConfiguration\n  };\n}\nexport * from \"./schema/createSchema\";","import React from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarContextInterface {\n  getToolState?(toolName: string): ProseMirrorToolState | undefined;\n  applyTool?(toolName: string): void;\n}\n\nconst ProseMirrorToolbarContext = React.createContext<\n  ProseMirrorToolbarContextInterface\n>({});\nexport default ProseMirrorToolbarContext;\n","import { IconButton } from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nexport interface ProseMirrorToolbarButtonProps {\n  toolName: string;\n}\n\nconst ProseMirrorToolbarIconButton: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolName } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolState = getToolState ? getToolState(toolName) : null;\n\n  const handleClick = React.useCallback(() => {\n    if (applyTool) {\n      applyTool(toolName);\n    }\n  }, [toolName, applyTool]);\n\n  if (!toolState) {\n    return null;\n  }\n\n  return (\n    <IconButton\n      onClick={handleClick}\n      size=\"small\"\n      disabled={!toolState.enabled}\n      color={toolState.active ? \"primary\" : \"default\"}\n      title={toolState.label}\n    >\n      {toolState.displayIcon ? toolState.displayIcon : toolState.label}\n    </IconButton>\n  );\n};\n\nexport default ProseMirrorToolbarIconButton;\n","import React, { ChangeEvent } from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\nimport { MenuItem, Select, WithStyles, withStyles } from \"@material-ui/core\";\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nconst styles = {\n  value: {\n    fontSize: 14,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"unset\" as \"unset\"\n  }\n};\n\nexport interface ProseMirrorToolbarButtonProps\n  extends WithStyles<typeof styles> {\n  toolNames: string[];\n  label?: string;\n}\n\nconst ProseMirrorToolbarDropdown: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolNames, classes, label } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolStates = toolNames\n    .map(toolName => {\n      const toolState = getToolState ? getToolState(toolName) : null;\n      return toolState;\n    })\n    .filter(x => x != null) as ProseMirrorToolState[];\n\n  const selected = toolStates.find(x => x.active);\n  const value = selected ? selected.name : \"\";\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<{ value: unknown }>) => {\n      if (applyTool) {\n        applyTool(event.target.value as string);\n      }\n    },\n    [applyTool]\n  );\n\n  // override renderValue so menu items can be styled\n  const renderValue = React.useCallback(\n    (toolName?: any) => {\n      if (!toolName) {\n        return label || \"\";\n      }\n\n      let toolState:\n        | { label: string; displayLabel?: React.ReactElement }\n        | undefined = getToolState ? getToolState(toolName) : undefined;\n\n      if (!toolState) {\n        toolState = { label: toolName };\n      }\n\n      if (toolState.displayLabel) {\n        return React.cloneElement(toolState.displayLabel, {\n          className: classes.value\n        });\n      }\n      return toolState.label;\n    },\n    [getToolState]\n  );\n\n  if (toolStates.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      renderValue={renderValue}\n      displayEmpty={true}\n    >\n      {toolStates.map(toolState => {\n        return (\n          <MenuItem value={toolState.name} key={toolState.name}>\n            {toolState.displayLabel ? (\n              toolState.displayLabel\n            ) : (\n              <span>{toolState.label}</span>\n            )}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarDropdown);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport clsx from \"clsx\";\n\nconst styles = {\n  root: {},\n  divider: {\n    verticalAlign: \"top\",\n    display: \"inline-flex\",\n    height: 13,\n    lineHeight: 13,\n    borderRight: \"1px solid rgb(218, 220, 224)\",\n    margin: \"9px 4px\"\n  },\n  empty: {\n    display: \"none\"\n  }\n};\n\nexport interface ProseMirrorToolbarGroupProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {}\n\nconst ProseMirrorToolbarGroup: React.SFC<ProseMirrorToolbarGroupProps> = (\n  props: ProseMirrorToolbarGroupProps\n) => {\n  const { children, classes } = props;\n\n  return (\n    <div\n      className={clsx(classes.root, {\n        [classes.empty]: !children\n      })}\n    >\n      {children}\n      <div className={classes.divider} />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarGroup);\n","import React from \"react\";\n\nimport {\n  Toolbar as MaterialToolbar,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\n\nimport { ProseMirrorToolbarContext } from \".\";\nimport { ProseMirrorToolbarIconButton } from \"../ProseMirrorToolbarIconButton\";\n\nimport ProseMirrorToolbarDropdown from \"../ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown\";\nimport { ProseMirrorToolbarGroup } from \"../ProseMirrorToolbarGroup\";\nimport { ProseMirrorToolbarState } from \"./ProseMirrorToolbarState\";\n\nconst styles = {\n  root: {\n    minHeight: 35,\n    borderBottom: \"1px solid rgb(218, 220, 224)\"\n  }\n};\n\nexport interface ToolbarButton {\n  type: \"button\";\n  toolName: string;\n}\n\nexport interface ToolbarDropDown {\n  type: \"dropdown\";\n  label?: string;\n  toolNames: string[];\n}\n\nexport interface ToolbarGroup {\n  type: \"group\";\n  children: ToolbarElement[];\n}\n\nexport type ToolbarElement = ToolbarButton | ToolbarGroup | ToolbarDropDown;\n\nexport interface ProseMirrorToolbarProps extends WithStyles<typeof styles> {\n  toolbarState?: ProseMirrorToolbarState;\n  layout: ToolbarElement[];\n}\n\nconst ProseMirrorToolbar: React.SFC<ProseMirrorToolbarProps> = (\n  props: ProseMirrorToolbarProps\n) => {\n  const { classes, layout, toolbarState } = props;\n\n  const renderToolbarElement = (element: ToolbarElement) => {\n    switch (element.type) {\n      case \"button\":\n        return <ProseMirrorToolbarIconButton toolName={element.toolName} />;\n      case \"dropdown\":\n        return (\n          <ProseMirrorToolbarDropdown\n            toolNames={element.toolNames}\n            label={element.label}\n          />\n        );\n      case \"group\":\n        return (\n          <ProseMirrorToolbarGroup>\n            {element.children.map(child => renderToolbarElement(child))}\n          </ProseMirrorToolbarGroup>\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <ProseMirrorToolbarContext.Provider\n      value={{\n        applyTool: (toolName: string) => {\n          if (!toolbarState) {\n            return;\n          }\n\n          const tool = toolbarState.tools.find(x => x.name === toolName);\n          if (!tool) {\n            return;\n          }\n\n          tool.apply(\n            toolbarState.editorView.state,\n            toolbarState.editorView.dispatch,\n            toolbarState.editorView\n          );\n        },\n        getToolState: (toolName: string) => {\n          if (!toolbarState) {\n            return undefined;\n          }\n\n          return toolbarState.toolStates[toolName];\n        }\n      }}\n    >\n      <MaterialToolbar className={classes.root} disableGutters={true}>\n        {layout.map(value => {\n          return renderToolbarElement(value);\n        })}\n      </MaterialToolbar>\n    </ProseMirrorToolbarContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbar);\n","import { ToolbarElement } from \"../ProseMirrorToolbar\";\n\nexport default [\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"undo\" },\n      { type: \"button\", toolName: \"redo\" }\n    ]\n  },\n\n  {\n    type: \"dropdown\",\n    label: \"Styles\",\n    toolNames: [\n      \"paragraph\",\n      \"heading_1\",\n      \"heading_2\",\n      \"heading_3\",\n      \"heading_4\",\n      \"heading_5\",\n      \"heading_6\",\n      \"code_block\"\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"strong\" },\n      { type: \"button\", toolName: \"em\" },\n      { type: \"button\", toolName: \"link\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"bullet_list\" },\n      { type: \"button\", toolName: \"ordered_list\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"dc-image-link\" },\n      { type: \"button\", toolName: \"image\" },\n      { type: \"button\", toolName: \"dc-content-link\" },\n      { type: \"button\", toolName: \"blockquote\" },\n      { type: \"button\", toolName: \"code_block\" },\n      { type: \"button\", toolName: \"horizontal_rule\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [{ type: \"button\", toolName: \"clear_formatting\" }]\n  }\n] as ToolbarElement[];\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Hyperlink } from \"@dc-extension-rich-text/common\";\n\ninterface HyperlinkDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Hyperlink) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst HyperlinkDialog: React.SFC<HyperlinkDialogProps> = (\n  props: HyperlinkDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Hyperlink>({\n    href: \"\",\n    title: \"\"\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.href));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      href: \"\",\n      title: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Hyperlink</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"href\"\n            label=\"Web Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.href}\n            onChange={event => handleInputChanged(\"href\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://www.storefront.com/black-friday\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default HyperlinkDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Image } from \"@dc-extension-rich-text/common\";\n\ninterface ImageDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Image) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst ImageDialog: React.SFC<ImageDialogProps> = (props: ImageDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Image>({\n    src: \"\",\n    alt: \"\",\n    title: \"\"\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.src));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      src: \"\",\n      alt: \"\",\n      title: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Insert Image from URL</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"src\"\n            label=\"Image Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.src}\n            onChange={event => handleInputChanged(\"src\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://cdn.storefront.com/image.jpg\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Image Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"alt\"\n            label=\"Image Alternative Text\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.alt}\n            onChange={event => handleInputChanged(\"alt\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Insert\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ImageDialog;\n","import { RichTextDialogs } from \"@dc-extension-rich-text/common\";\nimport React from \"react\";\n\nexport interface RichTextDialogsContext {\n  dialogs?: RichTextDialogs;\n}\n\nconst context = React.createContext<RichTextDialogsContext>({});\nexport default context;\n","import React, { PropsWithChildren } from \"react\";\n\nimport {\n  Hyperlink,\n  Image,\n  RichTextDialogs\n} from \"@dc-extension-rich-text/common\";\nimport { ContentItemLink, MediaImageLink } from \"dc-extensions-sdk\";\nimport HyperlinkDialog from \"../HyperlinkDialog/HyperlinkDialog\";\nimport ImageDialog from \"../ImageDialog/ImageDialog\";\nimport RichTextDialogsContext from \"./RichTextDialogsContext\";\n\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\n\ninterface EditorDialogsProps extends PropsWithChildren<{}> {}\n\ninterface OpenDialog {\n  type: string;\n  resolve: (value: any) => void;\n  reject: () => void;\n}\n\nconst RichTextDialogsContainer: React.SFC<EditorDialogsProps> = (\n  props: EditorDialogsProps\n) => {\n  const { children } = props;\n\n  const [openDialog, setOpenDialog] = React.useState<OpenDialog>();\n\n  const handleCloseDialog = React.useCallback(() => {\n    if (openDialog) {\n      openDialog.reject();\n    }\n    setOpenDialog(undefined);\n  }, [openDialog, setOpenDialog]);\n\n  const handleSubmitDialog = React.useCallback(\n    (value: any) => {\n      if (openDialog) {\n        openDialog.resolve(value);\n      }\n      setOpenDialog(undefined);\n    },\n    [openDialog, setOpenDialog]\n  );\n\n  const handleOpenDialog = React.useCallback(\n    (type: string) => {\n      return new Promise((resolve, reject) => {\n        setOpenDialog({\n          type,\n          resolve,\n          reject\n        });\n      });\n    },\n    [setOpenDialog]\n  );\n\n  const { sdk } = React.useContext(SdkContext);\n\n  const dialogs: RichTextDialogs = {\n    getHyperlink: (value?: Hyperlink): Promise<Hyperlink> => {\n      return handleOpenDialog(\"hyperlink\") as Promise<Hyperlink>;\n    },\n    getImage: (value?: Image): Promise<Image> => {\n      return handleOpenDialog(\"image\") as Promise<Image>;\n    },\n    getDcImageLink: (value?: MediaImageLink): Promise<MediaImageLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.mediaLink.getImage();\n      }\n    },\n    getDcContentLink: (\n      contentTypeIds: string[],\n      value?: ContentItemLink\n    ): Promise<ContentItemLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.contentLink.get(contentTypeIds);\n      }\n    }\n  };\n\n  return (\n    <RichTextDialogsContext.Provider value={{ dialogs }}>\n      {children}\n\n      <HyperlinkDialog\n        open={openDialog != null && openDialog.type === \"hyperlink\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <ImageDialog\n        open={openDialog != null && openDialog.type === \"image\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n    </RichTextDialogsContext.Provider>\n  );\n};\n\nexport default RichTextDialogsContainer;\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\nimport CodeTextArea from \"../CodeTextArea/CodeTextArea\";\nimport ProseMirror from \"../ProseMirror/ProseMirror\";\nimport { EditorView, ViewSwitcher } from \"../ViewSwitcher\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration,\n  RichLanguageFormat\n} from \"@dc-extension-rich-text/common\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport ProseMirrorToolbar, {\n  ToolbarElement\n} from \"../ProseMirrorToolbar/ProseMirrorToolbar\";\nimport DefaultToolbar from \"./DefaultToolbar\";\n\nimport { computeToolbarState } from \"../ProseMirrorToolbar/ProseMirrorToolbarState\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\"\n  },\n  frame: {\n    flex: 1,\n    display: \"flex\",\n    flexDirection: \"column\" as \"column\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    borderRadius: 5,\n    padding: \"0 10px 10px 10px\"\n  }\n};\n\ninterface RichTextLanguageMap {\n  [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n}\n\nexport interface RichTextEditorProps extends WithStyles<typeof styles> {\n  languages?: RichTextLanguageMap;\n  language?: string;\n\n  disableToolbar?: boolean;\n  toolbarLayout?: ToolbarElement[];\n\n  disableCodeView?: boolean;\n  readOnlyCodeView?: boolean;\n\n  editorViewOptions?: any;\n\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nconst RichTextEditor: React.SFC<RichTextEditorProps> = (\n  props: RichTextEditorProps\n) => {\n  const {\n    classes,\n    languages: languagesProp,\n    language: languageProp = \"markdown\",\n    toolbarLayout: toolbarLayoutProp,\n    disableToolbar = false,\n\n    disableCodeView = false,\n    readOnlyCodeView = false,\n\n    editorViewOptions,\n\n    value: valueProp,\n    onChange\n  } = props;\n\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const languages: RichTextLanguageMap = languagesProp || {\n    markdown: MarkdownLanguage({\n      dialogs\n    })\n  };\n\n  if (!languages[languageProp]) {\n    throw new Error(`Unable to find language ${props.language}`);\n  }\n\n  const { language, conf: languageConfiguration } = languages[languageProp];\n\n  const [view, setView] = React.useState(EditorView.EDIT);\n  const [rawValue, setRawValue] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    if (languageConfiguration.format === RichLanguageFormat.JSON) {\n      return JSON.stringify(valueProp, null, 3);\n    } else {\n      return valueProp;\n    }\n  });\n  const [proseMirrorDocument, setProseMirrorDocument] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    return language.parse(valueProp);\n  });\n\n  const handleRawValueChange = React.useCallback(\n    (value: any) => {\n      setRawValue(value);\n\n      if (languageConfiguration.format === RichLanguageFormat.JSON) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {\n          return;\n        }\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n\n      try {\n        const newProseMirrorDocument = language.parse(value);\n        setProseMirrorDocument(newProseMirrorDocument);\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setRawValue, setProseMirrorDocument, onChange]\n  );\n\n  const handleEditorChange = React.useCallback(\n    (doc: any) => {\n      setProseMirrorDocument(doc);\n      try {\n        const newRawValue = language.serialize(doc);\n\n        if (languageConfiguration.format === RichLanguageFormat.JSON) {\n          setRawValue(JSON.stringify(newRawValue, null, 3));\n        } else {\n          setRawValue(newRawValue);\n        }\n\n        if (onChange) {\n          onChange(newRawValue);\n        }\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setProseMirrorDocument, setRawValue]\n  );\n\n  const [toolbarState, setToolbarState] = React.useState();\n  const toolbarLayout = toolbarLayoutProp || DefaultToolbar;\n\n  const handleEditorUpdateState = React.useCallback(\n    (state: any, editorView: any) => {\n      setToolbarState(computeToolbarState(language.tools, state, editorView));\n    },\n    [language, setToolbarState]\n  );\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.frame}>\n        <ViewSwitcher\n          onChange={setView}\n          language={language.label}\n          disableCodeView={disableCodeView}\n        />\n        {view === EditorView.EDIT ? (\n          <div>\n            {disableToolbar ? (\n              false\n            ) : (\n              <ProseMirrorToolbar\n                toolbarState={toolbarState}\n                layout={toolbarLayout}\n              />\n            )}\n            <ProseMirror\n              editorViewOptions={editorViewOptions}\n              schema={language.schema}\n              onChange={handleEditorChange}\n              onUpdateState={handleEditorUpdateState}\n              doc={proseMirrorDocument}\n            />\n          </div>\n        ) : (\n          <CodeTextArea\n            value={rawValue}\n            onChange={handleRawValueChange}\n            readOnly={readOnlyCodeView}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditor);\n","import {\n  ProseMirrorTool,\n  ProseMirrorToolState\n} from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarState {\n  tools: ProseMirrorTool[];\n  toolStates: { [toolName: string]: ProseMirrorToolState };\n  editorView: any;\n}\n\nexport function computeToolbarState(\n  tools: ProseMirrorTool[],\n  editorState: any,\n  editorView: any\n): ProseMirrorToolbarState {\n  const toolStates: { [toolName: string]: ProseMirrorToolState } = {};\n\n  for (const tool of tools) {\n    const state = {\n      active: false,\n      enabled: true,\n      visible: true,\n      ...tool\n    };\n\n    if (tool.isActive) {\n      state.active = tool.isActive(editorState, editorView);\n    }\n\n    if (tool.isVisible) {\n      state.visible = tool.isVisible(editorState, editorView);\n    }\n\n    if (tool.isEnabled) {\n      state.enabled = tool.isEnabled(editorState, editorView);\n    }\n\n    toolStates[tool.name] = state;\n  }\n\n  return {\n    tools,\n    toolStates,\n    editorView\n  };\n}\n","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React from \"react\";\nimport { withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nvar styles = {\n  root: {\n    display: \"block\",\n    width: \"100%\",\n    minHeight: 150,\n    margin: \"0 10px 10px 0\",\n    position: \"relative\"\n  },\n  content: {},\n  \"empty-slot\": {},\n  \"populated-slot\": {}\n};\n\nvar InlineChooser = function InlineChooser(props) {\n  var _a;\n\n  var classes = props.classes,\n      children = props.children,\n      className = props.className,\n      _b = props.variant,\n      variant = _b === void 0 ? \"empty\" : _b,\n      aspectRatio = props.aspectRatio,\n      other = __rest(props, [\"classes\", \"children\", \"className\", \"variant\", \"aspectRatio\"]);\n\n  var aspectRatioPaddingTop = React.useMemo(function () {\n    if (!aspectRatio) {\n      return undefined;\n    }\n\n    var components = aspectRatio.split(':');\n\n    if (components.length !== 2) {\n      return undefined;\n    }\n\n    return Math.round(Number(components[1]) / Number(components[0]) * 100) + '%';\n  }, [aspectRatio]);\n  return React.createElement(\"div\", __assign({}, other, {\n    className: clsx(classes.root, (_a = {}, _a[classes[\"empty-slot\"]] = variant === \"empty-slot\", _a[classes[\"populated-slot\"]] = variant === \"populated-slot\", _a), className)\n  }), aspectRatio ? React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    style: {\n      display: 'block',\n      paddingTop: aspectRatioPaddingTop\n    }\n  }, \"\\xA0\"), React.createElement(\"div\", {\n    className: clsx(classes.content)\n  }, children)) : React.createElement(\"div\", {\n    className: clsx(classes.content)\n  }, children));\n};\n\nexport default withStyles(styles)(InlineChooser);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, DeleteIcon, StyledFab, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { CircularProgress, withStyles } from '@material-ui/core'; // tslint:disable-next-line\n\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage';\nimport clsx from 'clsx';\nvar styles = {\n  root: {\n    '&$broken, &$invalid': {\n      background: '#e5e5e5'\n    }\n  },\n  image: {\n    maxWidth: '100%'\n  },\n  loading: {},\n  broken: {},\n  invalid: {},\n  statusIcons: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    position: 'absolute',\n    alignItems: 'center',\n    alignContent: 'center',\n    flexDirection: 'row',\n    justifyContent: 'center'\n  }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n  var _a;\n\n  var node = props.node,\n      onDelete = props.onDelete,\n      classes = props.classes,\n      options = props.options;\n  var value = node.attrs.value; // BrokenImageIcon\n\n  var _b = React.useState(false),\n      broken = _b[0],\n      setBroken = _b[1];\n\n  var _c = React.useState(false),\n      loading = _c[0],\n      setLoading = _c[1];\n\n  var handleLoading = React.useCallback(function () {\n    setLoading(true);\n  }, [setLoading]);\n  var handleError = React.useCallback(function () {\n    setBroken(true);\n    setLoading(false);\n  }, [setBroken, setLoading]);\n  var handleLoaded = React.useCallback(function () {\n    setBroken(false);\n    setLoading(false);\n  }, [setBroken, setLoading]);\n  var hasValidValue = value && value.endpoint && value.name; //Workaround for ts-jest\n\n  var Fab = StyledFab;\n  return React.createElement(\"div\", {\n    className: clsx(classes.root, (_a = {}, _a[classes.broken] = broken, _a[classes.loading] = loading, _a[classes.invalid] = !hasValidValue, _a))\n  }, React.createElement(InlineChooser, {\n    variant: \"populated-slot\",\n    aspectRatio: broken || loading || !hasValidValue ? '3:1' : undefined\n  }, hasValidValue ? React.createElement(\"img\", {\n    className: classes.image,\n    src: \"//\" + (options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? options.dynamicContent.stagingEnvironment : value.defaultHost) + \"/i/\" + value.endpoint + \"/\" + encodeURIComponent(value.name),\n    onLoadStart: handleLoading,\n    onError: handleError,\n    onLoad: handleLoaded,\n    alt: \"\"\n  }) : false, React.createElement(\"div\", {\n    className: classes.statusIcons\n  }, loading ? React.createElement(CircularProgress, null) : broken || !hasValidValue ? React.createElement(BrokenImageIcon, {\n    fontSize: \"large\"\n  }) : false), React.createElement(ChooserActions, {\n    variant: \"populated-slot\"\n  }, React.createElement(Fab, {\n    variant: \"dark\",\n    onClick: onDelete\n  }, DeleteIcon))));\n});\n\nvar DcImageLinkView =\n/** @class */\nfunction () {\n  function DcImageLinkView(node, view, getPos, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.options = options;\n    this.dom = document.createElement('div');\n    this.handleDelete = this.handleDelete.bind(this);\n    this.render();\n  }\n\n  DcImageLinkView.prototype.handleDelete = function () {\n    var start = this.getPos();\n    var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n    this.view.dispatch(tr);\n  };\n\n  DcImageLinkView.prototype.render = function () {\n    ReactDOM.render(withTheme(React.createElement(ViewComponent, {\n      options: this.options,\n      node: this.node,\n      onDelete: this.handleDelete\n    })), this.dom);\n  };\n\n  return DcImageLinkView;\n}();\n\nexport { DcImageLinkView };","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, ContentItem as ContentItemIcon, DeleteIcon, getContentTypeCard, getContentTypeIcon, StyledFab, Visualization, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { withStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nvar styles = {\n  root: {\n    '&$broken, &$invalid': {\n      background: '#e5e5e5'\n    },\n    boxShadow: \"0 1px 5px 0 rgba(23,32,44,.2), 0 2px 2px 0 rgba(23,32,44,.1), 0 3px 1px -2px rgba(23,32,44,.1)\"\n  },\n  invalid: {},\n  content: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundSize: \"contain\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundPosition: \"50%\"\n  },\n  statusIcons: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    position: 'absolute',\n    alignItems: 'center',\n    alignContent: 'center',\n    flexDirection: 'row',\n    justifyContent: 'center'\n  }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n  var _a;\n\n  var node = props.node,\n      onDelete = props.onDelete,\n      classes = props.classes,\n      options = props.options;\n  var value = node.attrs.value;\n  var hasValidValue = value && value.id && value.contentType;\n  var contentLinkOptions = options.tools && options.tools[\"dc-content-link\"] ? options.tools[\"dc-content-link\"] : undefined;\n  var customIcon = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeIcon(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\n  var cardTemplateUrl = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeCard(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\n  var aspectRatio = contentLinkOptions && contentLinkOptions.contentTypeSettings && contentLinkOptions.contentTypeSettings.aspectRatios && hasValidValue ? getContentTypeAspectRatio(contentLinkOptions.contentTypeSettings.aspectRatios, value.contentType) : undefined; //Workaround for ts-jest\n\n  var Fab = StyledFab;\n  return React.createElement(\"div\", {\n    className: clsx(classes.root, (_a = {}, _a[classes.invalid] = !hasValidValue, _a))\n  }, React.createElement(InlineChooser, {\n    variant: \"populated-slot\",\n    aspectRatio: aspectRatio || '3:1'\n  }, React.createElement(\"div\", {\n    className: clsx(classes.content),\n    style: {\n      backgroundImage: \"url(\" + (customIcon || ContentItemIcon) + \")\"\n    }\n  }, cardTemplateUrl && options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? React.createElement(Visualization, {\n    template: cardTemplateUrl,\n    params: {\n      contentItemId: value.id,\n      stagingEnvironment: options.dynamicContent.stagingEnvironment\n    }\n  }) : false), React.createElement(ChooserActions, {\n    variant: \"populated-slot\"\n  }, React.createElement(Fab, {\n    variant: \"dark\",\n    onClick: onDelete\n  }, DeleteIcon))));\n});\nexport function getContentTypeAspectRatio(aspectRatios, schemaId) {\n  for (var _i = 0, _a = Object.keys(aspectRatios); _i < _a.length; _i++) {\n    var key = _a[_i];\n\n    if (key === \"*\" || key === schemaId) {\n      return aspectRatios[key];\n    }\n  }\n}\n\nvar DcContentLinkView =\n/** @class */\nfunction () {\n  function DcContentLinkView(node, view, getPos, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.options = options;\n    this.dom = document.createElement('div');\n    this.handleDelete = this.handleDelete.bind(this);\n    this.render();\n  }\n\n  DcContentLinkView.prototype.handleDelete = function () {\n    var start = this.getPos();\n    var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n    this.view.dispatch(tr);\n  };\n\n  DcContentLinkView.prototype.render = function () {\n    ReactDOM.render(withTheme(React.createElement(ViewComponent, {\n      options: this.options,\n      node: this.node,\n      onDelete: this.handleDelete\n    })), this.dom);\n  };\n\n  return DcContentLinkView;\n}();\n\nexport { DcContentLinkView };","var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport React from 'react';\nimport { isToolEnabled } from '@dc-extension-rich-text/common'; // tslint:disable-next-line\n\nimport AddCircleIcon from '@material-ui/icons/AddCircle'; // tslint:disable-next-line\n\nimport ImageSearchIcon from '@material-ui/icons/ImageSearch';\nexport function dcImageLink(schema, dialog) {\n  var _this = this;\n\n  var node = schema.nodes['dc-image-link'];\n  return {\n    name: 'dc-image-link',\n    label: 'Insert Image',\n    displayIcon: React.createElement(ImageSearchIcon, null),\n    apply: function apply(state, dispatch, view) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var value, err_1;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!dialog) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , dialog()];\n\n            case 2:\n              value = _a.sent();\n              view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\n                value: value\n              })));\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              err_1 = _a.sent();\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  };\n}\nexport function dcContentLink(schema, contentTypes, dialog) {\n  var _this = this;\n\n  var node = schema.nodes['dc-content-link'];\n  return {\n    name: 'dc-content-link',\n    label: 'Insert Content',\n    displayIcon: React.createElement(AddCircleIcon, null),\n    apply: function apply(state, dispatch, view) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var value, err_2;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!dialog) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , dialog(contentTypes)];\n\n            case 2:\n              value = _a.sent();\n              view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\n                value: value\n              })));\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              err_2 = _a.sent();\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  };\n}\nexport function createDynamicContentTools(schema, options) {\n  var tools = [];\n\n  if (isToolEnabled('dc-image-link', options) && schema.nodes['dc-image-link']) {\n    tools.push(dcImageLink(schema, options.dialogs ? options.dialogs.getDcImageLink : undefined));\n  }\n\n  if (isToolEnabled('dc-content-link', options) && schema.nodes['dc-content-link'] && // must provide a list of content types for this tool to be active\n  options.tools && options.tools[\"dc-content-link\"] && options.tools[\"dc-content-link\"].contentTypes && options.tools[\"dc-content-link\"].contentTypes) {\n    tools.push(dcContentLink(schema, options.tools[\"dc-content-link\"].contentTypes, options.dialogs ? options.dialogs.getDcContentLink : undefined));\n  }\n\n  return tools;\n}","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar DcContentLinkBlock =\n/** @class */\nfunction () {\n  function DcContentLinkBlock() {}\n\n  DcContentLinkBlock.prototype.canSerialize = function (schema, node) {\n    return node.type === \"dc-content-link\";\n  };\n\n  DcContentLinkBlock.prototype.serialize = function (schema, nodes) {\n    return nodes.map(function (node) {\n      return {\n        type: \"dc-content-link\",\n        data: node.attrs.value\n      };\n    });\n  };\n\n  DcContentLinkBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"dc-content-link\";\n  };\n\n  DcContentLinkBlock.prototype.parse = function (schema, blocks) {\n    var result = [];\n    blocks.forEach(function (block) {\n      result.push({\n        type: \"dc-content-link\",\n        attrs: {\n          value: block.data\n        }\n      });\n    });\n    return result;\n  };\n\n  return DcContentLinkBlock;\n}();\n\nexport default DcContentLinkBlock;","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar DcImageLinkBlock =\n/** @class */\nfunction () {\n  function DcImageLinkBlock() {}\n\n  DcImageLinkBlock.prototype.canSerialize = function (schema, node) {\n    return node.type === \"dc-image-link\";\n  };\n\n  DcImageLinkBlock.prototype.serialize = function (schema, nodes) {\n    return nodes.map(function (node) {\n      return {\n        type: \"dc-image-link\",\n        data: node.attrs.value\n      };\n    });\n  };\n\n  DcImageLinkBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"dc-image-link\";\n  };\n\n  DcImageLinkBlock.prototype.parse = function (schema, blocks) {\n    var result = [];\n    blocks.forEach(function (block) {\n      result.push({\n        type: \"dc-image-link\",\n        attrs: {\n          value: block.data\n        }\n      });\n    });\n    return result;\n  };\n\n  return DcImageLinkBlock;\n}();\n\nexport default DcImageLinkBlock;","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar MarkdownBlock =\n/** @class */\nfunction () {\n  function MarkdownBlock() {}\n\n  MarkdownBlock.prototype.canSerialize = function (schema, node) {\n    if (!node.type) {\n      return false;\n    } else {\n      return markdown.defaultMarkdownSerializer.nodes[node.type] != null;\n    }\n  };\n\n  MarkdownBlock.prototype.serialize = function (schema, nodes) {\n    var parsedNodes = Node.fromJSON(schema, {\n      type: \"doc\",\n      content: nodes\n    });\n    return [{\n      type: \"markdown\",\n      data: markdown.defaultMarkdownSerializer.serialize(parsedNodes)\n    }];\n  };\n\n  MarkdownBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"markdown\";\n  };\n\n  MarkdownBlock.prototype.parse = function (schema, blocks) {\n    var result = [];\n    blocks.forEach(function (block) {\n      var doc = markdown.defaultMarkdownParser.parse(block.data).toJSON();\n      result = result.concat.apply(result, doc.content);\n    });\n    return result;\n  };\n\n  return MarkdownBlock;\n}();\n\nexport default MarkdownBlock;","import { createSchema as createMarkdownSchema } from \"@dc-extension-rich-text/language-markdown\";\nimport { DcContentLinkNode, DcImageLinkNode } from \"@dc-extension-rich-text/prosemirror-dynamic-content\"; // tslint:disable-next-line\n\nvar Schema = require(\"prosemirror-model\").Schema;\n\nexport function createSchema() {\n  var schema = createMarkdownSchema();\n  return new Schema({\n    nodes: schema.spec.nodes.addBefore(\"image\", \"dc-image-link\", DcImageLinkNode()).addBefore(\"image\", \"dc-content-link\", DcContentLinkNode()),\n    marks: schema.spec.marks\n  });\n}","var __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nimport { createStandardTools } from \"@dc-extension-rich-text/common\";\nimport { createDynamicContentTools } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport DcContentLinkBlock from \"./blocks/DcContentLinkBlock\";\nimport DcImageLinkBlock from \"./blocks/DcImageLinkBlock\";\nimport MarkdownBlock from \"./blocks/MarkdownBlock\";\nimport { createSchema } from \"./schema/createSchema\"; // tslint:disable-next-line\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar JSONLanguage =\n/** @class */\nfunction () {\n  function JSONLanguage(options, blockTypes) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (blockTypes === void 0) {\n      blockTypes = [new MarkdownBlock(), new DcImageLinkBlock(), new DcContentLinkBlock()];\n    }\n\n    this.blockTypes = blockTypes;\n    this.name = \"json\";\n    this.label = \"JSON\";\n    var schema = createSchema();\n\n    var tools = __spreadArrays(createStandardTools(schema, options), createDynamicContentTools(schema, options));\n\n    this.schema = schema;\n    this.tools = tools;\n  }\n\n  JSONLanguage.prototype.serialize = function (doc) {\n    var _this = this;\n\n    if (!doc) {\n      return [];\n    }\n\n    doc = doc.toJSON();\n    var fragments = [];\n\n    if (!doc.content || doc.content.length === 0) {\n      return fragments;\n    }\n\n    var nodesByConverter = groupBy(doc.content, function (node) {\n      for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n        var blockType = _a[_i];\n\n        if (blockType.canSerialize(_this.schema, node)) {\n          return blockType;\n        }\n      }\n    });\n    var blocks = [];\n\n    for (var _i = 0, nodesByConverter_1 = nodesByConverter; _i < nodesByConverter_1.length; _i++) {\n      var group = nodesByConverter_1[_i];\n      var groupBlocks = group.group.serialize(this.schema, group.items);\n      blocks = blocks.concat.apply(blocks, groupBlocks);\n    }\n\n    return blocks;\n  };\n\n  JSONLanguage.prototype.parse = function (blocks) {\n    var _this = this;\n\n    if (!blocks || blocks.length === 0) {\n      return Node.fromJSON(this.schema, {\n        type: \"doc\",\n        content: [{\n          type: \"paragraph\"\n        }]\n      });\n    }\n\n    var result = {\n      type: \"doc\",\n      content: []\n    };\n    var blocksGroupedByConverter = groupBy(blocks, function (block) {\n      for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n        var blockType = _a[_i];\n\n        if (blockType.canParse(_this.schema, block)) {\n          return blockType;\n        }\n      }\n    });\n\n    for (var _i = 0, blocksGroupedByConverter_1 = blocksGroupedByConverter; _i < blocksGroupedByConverter_1.length; _i++) {\n      var group = blocksGroupedByConverter_1[_i];\n      var parsedNodes = group.group.parse(this.schema, group.items);\n      result.content = result.content.concat.apply(result.content, parsedNodes);\n    }\n\n    return Node.fromJSON(this.schema, result);\n  };\n\n  return JSONLanguage;\n}();\n\nexport default JSONLanguage;\n\nfunction groupBy(items, groupFn) {\n  var result = [];\n  var currentGroup = null;\n  var currentGroupItems = [];\n\n  for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n    var item = items_1[_i];\n    var itemGroup = groupFn(item);\n\n    if (itemGroup === undefined) {\n      continue;\n    }\n\n    if (currentGroup === null) {\n      currentGroup = itemGroup;\n      currentGroupItems = [item];\n    } else if (currentGroup === itemGroup) {\n      currentGroupItems.push(item);\n    } else {\n      if (currentGroupItems.length > 0) {\n        result.push({\n          group: currentGroup,\n          items: currentGroupItems\n        });\n      }\n\n      currentGroup = itemGroup;\n      currentGroupItems = [item];\n    }\n  }\n\n  if (currentGroupItems.length > 0 && currentGroup !== null) {\n    result.push({\n      group: currentGroup,\n      items: currentGroupItems\n    });\n  }\n\n  return result;\n}","export function DcImageLinkNode() {\n  return {\n    content: \"block\",\n    group: \"block\",\n    defining: true,\n    attrs: {\n      value: {}\n    },\n    nodeSize: 1,\n    draggable: true,\n    atom: true,\n    parseDOM: [{\n      tag: \"dc-image-link[data-dc-image-link]\",\n      getAttrs: function getAttrs(dom) {\n        var value = JSON.parse(dom.getAttribute(\"data-dc-image-link\"));\n        return {\n          value: value\n        };\n      }\n    }],\n    toDOM: function toDOM(node) {\n      var value = node.attrs.value;\n      return [\"dc-image-link\", {\n        \"data-dc-image-link\": JSON.stringify(value)\n      }];\n    }\n  };\n}","export function DcContentLinkNode() {\n  return {\n    content: \"block\",\n    group: \"block\",\n    defining: true,\n    attrs: {\n      value: {}\n    },\n    nodeSize: 1,\n    draggable: true,\n    atom: true,\n    parseDOM: [{\n      tag: \"dc-content-link[data-dc-content-link]\",\n      getAttrs: function getAttrs(dom) {\n        var value = JSON.parse(dom.getAttribute(\"data-dc-content-link\"));\n        return {\n          value: value\n        };\n      }\n    }],\n    toDOM: function toDOM(node) {\n      var value = node.attrs.value;\n      return [\"dc-content-link\", {\n        \"data-dc-content-link\": JSON.stringify(value)\n      }];\n    }\n  };\n}","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n  format: RichLanguageFormat.JSON\n};\nexport default conf;","import React from \"react\";\n\nimport { withStyles, WithStyles } from \"@material-ui/core\";\n\nimport { ToolbarElement } from \"../ProseMirrorToolbar\";\nimport { RichTextEditor } from \"../RichTextEditor\";\n\nimport JSONLanguage from \"@dc-extension-rich-text/language-json\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport { ContentTypeSettings, SdkContext } from \"unofficial-dynamic-content-ui\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration\n} from \"@dc-extension-rich-text/common\";\nimport {\n  DcContentLinkView,\n  DcImageLinkView,\n  DynamicContentToolOptions\n} from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nexport const styles = {\n  root: {\n    width: \"100%\"\n  }\n};\n\nexport interface EditorRichTextFieldProps extends WithStyles<typeof styles> {\n  schema: any;\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nexport interface EditorRichTextFieldParams {\n  language?: string;\n\n  styles?: string;\n  stylesheet?: string;\n\n  codeView?: {\n    readOnly?: boolean;\n    disabled?: boolean;\n  };\n\n  editView?: {};\n\n  toolbar?: {\n    layout?: ToolbarElement[];\n    disabled?: boolean;\n  };\n\n  tools?: {\n    whitelist?: string[];\n    blacklist?: string[];\n\n    \"dc-content-link\"?: {\n      contentTypes?: string[];\n      contentTypeSettings?: ContentTypeSettings & {\n        aspectRatios?: { [schemaId: string]: string };\n      };\n    };\n  };\n}\n\nconst EditorRichTextField: React.SFC<EditorRichTextFieldProps> = (\n  props: EditorRichTextFieldProps\n) => {\n  const { schema, value: valueProp, onChange, classes } = props;\n\n  const params: EditorRichTextFieldParams =\n    schema && schema[\"ui:extension\"] && schema[\"ui:extension\"].params\n      ? schema[\"ui:extension\"].params\n      : {};\n\n  const { sdk } = React.useContext(SdkContext);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const toolOptions = React.useMemo<DynamicContentToolOptions>(() => {\n    const settings = {\n      dialogs,\n      dynamicContent: {\n        stagingEnvironment: sdk ? sdk.stagingEnvironment : undefined\n      },\n      tools: params.tools\n    };\n\n    if (settings.tools && !settings.tools.blacklist) {\n      // disable inline_styles by default\n      settings.tools.blacklist = [\"inline_styles\"];\n    }\n\n    return settings;\n  }, [sdk, dialogs, params]);\n\n  const languages = React.useMemo<{\n    [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n  }>(() => {\n    return {\n      markdown: MarkdownLanguage(toolOptions),\n      json: JSONLanguage(toolOptions)\n    };\n  }, []);\n\n  const language = params.language || \"markdown\";\n\n  const editorViewOptions = React.useMemo(() => {\n    return {\n      nodeViews: {\n        \"dc-image-link\": (node: any, view: any, getPos: any) =>\n          new DcImageLinkView(node, view, getPos, toolOptions),\n        \"dc-content-link\": (node: any, view: any, getPos: any) =>\n          new DcContentLinkView(node, view, getPos, toolOptions)\n      }\n    };\n  }, [sdk, toolOptions]);\n\n  return (\n    <div className={classes.root}>\n      {params.styles ? (\n        <style dangerouslySetInnerHTML={{ __html: params.styles }} />\n      ) : (\n        false\n      )}\n      {params.stylesheet ? (\n        <link rel=\"stylesheet\" href={params.stylesheet} />\n      ) : (\n        false\n      )}\n\n      <RichTextEditor\n        languages={languages}\n        language={params.language}\n        editorViewOptions={editorViewOptions}\n        toolbarLayout={params.toolbar ? params.toolbar.layout : undefined}\n        disableToolbar={params.toolbar ? params.toolbar.disabled : undefined}\n        disableCodeView={params.codeView ? params.codeView.disabled : undefined}\n        readOnlyCodeView={\n          params.codeView ? params.codeView.readOnly : undefined\n        }\n        onChange={onChange}\n        value={valueProp}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(EditorRichTextField);\n","import JSONLanguage from \"./JSONLanguage\";\nimport JSONLanguageConfiguration from \"./JSONLanguageConfiguration\";\nexport default function (options) {\n  return {\n    language: new JSONLanguage(options),\n    conf: JSONLanguageConfiguration\n  };\n}\nexport * from \"./JSONLanguage\";\nexport * from \"./JSONLanguageConfiguration\";\nexport * from \"./schema/createSchema\";\nexport * from \"./blocks/DcImageLinkBlock\";\nexport * from \"./blocks/MarkdownBlock\";","import React from \"react\";\n\nimport { init, SDK } from \"dc-extensions-sdk\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\nimport EditorRichTextField from \"./EditorRichTextField/EditorRichTextField\";\nimport { RichTextDialogsContainer } from \"./RichTextDialogs\";\n\ninterface AppState {\n  connected: boolean;\n  sdk?: SDK;\n  value?: string;\n}\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = { connected: false };\n    this.handleValueChange = this.handleValueChange.bind(this);\n    this.handleChooseLink = this.handleChooseLink.bind(this);\n  }\n\n  public componentDidMount(): void {\n    this.handleConnect();\n  }\n\n  public async handleConnect(): Promise<void> {\n    const sdk: SDK = await init();\n    sdk.frame.startAutoResizer();\n\n    const value: any = await sdk.field.getValue();\n    this.setState({\n      sdk,\n      connected: true,\n      value\n    });\n  }\n\n  public handleValueChange(value: any): void {\n    if (this.state.connected && this.state.sdk) {\n      this.state.sdk.field.setValue(value);\n    }\n  }\n\n  public async handleChooseLink(): Promise<{ href: string; title: string }> {\n    return { href: \"\", title: \"\" };\n  }\n\n  public render(): React.ReactElement {\n    const { connected, value, sdk } = this.state;\n\n    return (\n      <div className=\"App\">\n        {connected && sdk ? (\n          <div>\n            <SdkContext.Provider value={{ sdk }}>\n              <RichTextDialogsContainer>\n                <EditorRichTextField onChange={this.handleValueChange} value={value} schema={sdk.field.schema} />\n              </RichTextDialogsContainer>\n            </SdkContext.Provider>\n          </div>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}