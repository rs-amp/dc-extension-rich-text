{"version":3,"sources":["CodeTextArea/CodeTextArea.tsx","ProseMirror/ProseMirror.tsx","ViewSwitcher/ViewSwitcher.tsx","../../common/dist/languages/RichLanguageFormat.js","../../common/dist/utils/ProseMirrorUtils.js","../../common/dist/tools/StandardToolOptions.js","../../common/dist/tools/StandardTools.js","../../language-markdown/dist/alignment/AlignmentTools.js","../../language-markdown/dist/anchor/AnchorNode.js","../../language-markdown/dist/anchor/AnchorTool.js","../../language-markdown/dist/anchor/AnchorToMarkdown.js","../../language-markdown/dist/inline_styles/InlineStylesMark.js","../../language-markdown/dist/utils/MarkUtils.js","../../language-markdown/dist/inline_styles/InlineStylesTool.js","../../language-markdown/dist/inline_styles/InlineStylesToMarkdown.js","../../language-markdown/dist/alignment/RecursiveHtmlBlock.js","../../language-markdown/dist/soft_hyphen/SoftHyphenFromMarkdown.js","../../language-markdown/dist/soft_hyphen/SoftHyphenNode.js","../../language-markdown/dist/soft_hyphen/SoftHyphenToMarkdown.js","../../language-markdown/dist/markdown/MarkdownParser.js","../../language-markdown/dist/alignment/AlignmentPlugin.js","../../language-markdown/dist/tables/TableToMarkdown.js","../../language-markdown/dist/markdown/MarkdownSerializer.js","../../language-markdown/dist/schema/createSchema.js","../../language-markdown/dist/tables/TableTools.js","../../language-markdown/dist/MarkdownLanguage.js","../../language-markdown/dist/soft_hyphen/SoftHyphenTool.js","../../language-markdown/dist/MarkdownLanguageConfiguration.js","../../language-markdown/dist/index.js","ProseMirrorToolbar/ProseMirrorToolbarContext.ts","ProseMirrorToolbarIconButton/ProseMirrorToolbarIconButton.tsx","ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown.tsx","ProseMirrorToolbarGroup/ProseMirrorToolbarGroup.tsx","ProseMirrorToolbar/ProseMirrorToolbar.tsx","RichTextEditor/DefaultToolbar.ts","AnchorDialog/AnchorDialog.tsx","HyperlinkDialog/HyperlinkDialog.tsx","ImageDialog/ImageDialog.tsx","RichTextDialogs/RichTextDialogsContext.ts","RichTextDialogs/RichTextDialogsContainer.tsx","RichTextEditor/RichTextEditor.tsx","ProseMirrorToolbar/ProseMirrorToolbarState.ts","../../prosemirror-dynamic-content/dist/InlineChooser/InlineChooser.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkView.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkView.js","../../prosemirror-dynamic-content/dist/DynamicContentTools/DynamicContentTools.js","../../language-json/dist/blocks/DcContentLinkBlock.js","../../language-json/dist/blocks/DcImageLinkBlock.js","../../language-json/dist/blocks/MarkdownBlock.js","../../language-json/dist/schema/createSchema.js","../../language-json/dist/JSONLanguage.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkNode.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkNode.js","../../language-json/dist/JSONLanguageConfiguration.js","EditorRichTextField/EditorRichTextField.tsx","../../language-json/dist/index.js","App.tsx","index.tsx"],"names":["withStyles","root","flex","display","minHeight","maxHeight","textarea","outline","resize","backgroundColor","border","padding","fontFamily","fontSize","props","classes","value","onChange","readOnly","handleChange","React","useCallback","event","target","className","EditorState","require","EditorView","exampleSetup","tableEditing","columnResizing","keymap","sinkListItem","liftOutOfList","undoInputRule","getKeys","schema","Tab","nodes","list_item","Backspace","state","dispatch","range","ProseMirror","ref","createRef","this","doc","tablePlugins","table","create","plugins","menuBar","parent","onUpdateState","editorState","createEditorState","view","editorViewOptions","dispatchTransaction","transaction","applyTransaction","transactions","updateState","some","tr","docChanged","forceUpdate","editorView","createEditorView","current","setState","Component","width","overflowY","RichLanguageFormat","button","transition","height","cursor","background","borderTop","borderBottom","color","fontWeight","selected","borderBottomColor","language","disableCodeView","disableEditView","useState","CODE","EDIT","selectedView","setSelectedView","renderButton","label","onClick","clsx","type","role","inBlock","selection","$from","depth","isMarkActive","_a","from","to","empty","isInSet","storedMarks","marks","rangeHasMark","getSelectionMarks","$to","currentMarks","nodesBetween","pos","node","start","forEach","mark","push","nodeSize","canInsert","d","index","canReplaceWith","isToolEnabled","toolName","options","tools","blacklist","indexOf","whitelist","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","undoFn","undo","redoFn","redo","toggleMark","setBlockType","lift","wrapInList","findParentNode","createMarkToggleTool","name","icon","displayIcon","isActive","editLink","dialog","_this","attrs","linkValue","newAttrs","filter","undefined","href","title","addMark","insertImage","imageValue","replaceSelectionWith","createAndFill","src","alt","blockTypeCommand","x","align","getCurrentAlignment","heading","level","displayLabel","createElement","style","margin","isEnabled","createStandardTools","strong","em","code","link","dialogs","getHyperlink","isVisible","bullet_list","ordered_list","image","getImage","blockquote","paragraph","code_block","command","horizontal_rule","$cursor","ranges","_i","marks_1","removeStoredMark","ranges_1","_b","_c","keys","markName","removeMark","getContainingTextBlocks","resultNodes","Set","isTextblock","has","add","Array","alignment","item","setNodeMarkup","alignActive","anyMismatch","alignable","group","inline","parseDOM","tag","getAttrs","dom","JSON","parse","getAttribute","toDOM","stringify","insertAnchor","anchorValue","AnchorToMarkdown","anchor","id","attrsSerialized","map","key","join","write","inline_styles","class","default","attributes","getMarkFromRange","markType","find","mergeAttrs","oldAttrs","inlineStyleClassNameTool","classLabel","existingMark","getStoredMark","addStoredMark","ref$1","ref$2","$from$1","$to$1","markAttrs","scrollIntoView","found","rangeHasFilteredMark","isFilteredMarkActive","m","InlineStylesToMarkdown","open","close","HTML_OPEN_CLOSE_TAG_RE","RegExp","HTML_SEQUENCES","source","html_block","startLine","endLine","silent","nextLine","token","lineText","bMarks","tShift","max","eMarks","sCount","blkIndent","md","html","charCodeAt","slice","test","content","getLines","DOMParser","parseFromString","firstChild","innerContent","innerHTML","line","meta","tagName","children","soft_hyphen_from","soft_hyphen","SoftHyphenToMarkdown","markdown","markdownit","markdownItTable","createMarkdownParser","use","ruler","before","block","parser","MarkdownParser","defaultMarkdownParser","tokens","tok","attrGet","th","td","tokenHandlers","html_inline","trim","startsWith","endsWith","nodeName","toLowerCase","openMark","closeMark","addNode","hard_break","alignedParagraphTypes","Map","html_block_open","alignAttr","nodeType","get","Number","openNode","html_block_close","closeNode","paragraph_align","getHeadingAttrs","heading_align","defining","AlignedParagraphToMarkdown","renderInline","closeBlock","AlignedHeaderToMarkdown","repeat","defaultRowWidth","withTableEscapes","action","out","substr","trimEnd","replace","padEnd","closed","TableToMarkdown","rows","childCount","child","maybeChild","render","columnCount","table_row","_loop_1","table_cell","table_header","createMarkdownSerializer","MarkdownSerializer","defaultMarkdownSerializer","tableNodes","Schema","createSchema","isInlineStylesEnabled","spec","addToEnd","append","tableGroup","cellContent","cellAttributes","getFromDOM","setDOMAttr","update","Fragment","inTable","path","$head","generateEmptyCell","fromArray","insertTable","__spreadArrays","il","r","k","a","j","jl","createMarkdownTools","concat","inlineStylesOptions","classNames","createInlineStylesTools","AnchorTool","getAnchor","SoftHyphenTool","FormatAlignLeft","FormatAlignCenter","FormatAlignRight","FormatAlignJustify","CreateTableTool","BorderClear","VerticalAlignBottom","LastPage","VerticalAlignTop","FirstPage","MarkdownLanguage","serializer","serialize","data","format","TEXT","conf","MarkdownLanguageConfiguration","ProseMirrorToolbarContext","createContext","useContext","getToolState","applyTool","toolState","handleClick","focus","document","activeElement","setTimeout","visible","IconButton","onMouseDown","size","disabled","enabled","active","paddingLeft","paddingRight","toolNames","toolStates","selectedItems","renderValue","cloneElement","Select","displayEmpty","preventDefault","MenuItem","alignItems","divider","verticalAlign","lineHeight","borderRight","layout","toolbarState","renderToolbarElement","element","findIndex","tool","toolVisible","Provider","areInlineStyles","clearFormatting","disableGutters","htmlIdRegex","AnchorDialog","onClose","onSubmit","setValue","lastValue","setLastValue","isValid","setIsValid","handleInputChanged","fieldValue","newValue","validateId","reset","handleCancel","handleSubmit","Dialog","maxWidth","fullWidth","aria-labelledby","DialogTitle","DialogContent","FormControl","TextField","error","autoFocus","required","FormHelperText","DialogActions","Button","HyperlinkDialog","validateUrl","ImageDialog","context","RichTextDialogsContainer","openDialog","setOpenDialog","handleCloseDialog","handleSubmitDialog","handleOpenDialog","sdk","SdkContext","getDcImageLink","mediaLink","getDcContentLink","contentTypeIds","contentLink","RichTextDialogsContext","frame","flexDirection","borderRadius","languagesProp","languages","languageProp","toolbarLayoutProp","toolbarLayout","disableToolbar","readOnlyCodeView","valueProp","Error","languageConfiguration","setView","rawValue","setRawValue","err","proseMirrorDocument","setProseMirrorDocument","handleRawValueChange","newProseMirrorDocument","handleEditorChange","newRawValue","setToolbarState","DefaultToolbar","handleEditorUpdateState","computeToolbarState","__rest","getOwnPropertySymbols","propertyIsEnumerable","position","variant","aspectRatio","other","aspectRatioPaddingTop","useMemo","components","split","Math","round","paddingTop","ViewComponent","loading","broken","invalid","statusIcons","top","left","right","bottom","alignContent","justifyContent","onDelete","setBroken","setLoading","handleLoading","handleError","handleLoaded","hasValidValue","endpoint","Fab","dynamicContent","stagingEnvironment","defaultHost","encodeURIComponent","onLoadStart","onError","onLoad","CircularProgress","DcImageLinkView","getPos","handleDelete","bind","delete","boxShadow","backgroundSize","backgroundRepeat","backgroundPosition","contentType","contentLinkOptions","customIcon","contentTypeSettings","cardTemplateUrl","aspectRatios","schemaId","getContentTypeAspectRatio","backgroundImage","template","params","contentItemId","DcContentLinkView","createDynamicContentTools","contentTypes","Node","DcContentLinkBlock","canSerialize","canParse","blocks","DcImageLinkBlock","MarkdownBlock","ensureInit","parsedNodes","fromJSON","toJSON","getDefaultSerializerParser","JSONLanguage","blockTypes","addBefore","draggable","atom","nodesByConverter","groupBy","blockType","nodesByConverter_1","groupBlocks","items","blocksGroupedByConverter","blocksGroupedByConverter_1","groupFn","currentGroup","currentGroupItems","items_1","itemGroup","toolOptions","settings","json","JSONLanguageConfiguration","nodeViews","styles","dangerouslySetInnerHTML","__html","stylesheet","rel","toolbar","codeView","App","connected","handleValueChange","handleChooseLink","handleConnect","init","startAutoResizer","field","getValue","withTheme","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.1ad47ac5.chunk.js","sourcesContent":["import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\n\nconst styles = {\n  root: {\n    flex: 1,\n    display: \"flex\",\n    minHeight: 286,\n    maxHeight: 500\n  },\n  textarea: {\n    flex: 1,\n    outline: \"none\" as \"none\",\n    resize: \"none\" as \"none\",\n    backgroundColor: \"#f0f0f0\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    padding: \"10px 8px 0\",\n    fontFamily: \"roboto,monospace!important\",\n    fontSize: 13\n  }\n};\n\nexport interface CodeTextAreaProps extends WithStyles<typeof styles> {\n  readOnly?: boolean;\n  value: string;\n  onChange?: (value: string) => void;\n}\n\nconst CodeTextArea: React.SFC<CodeTextAreaProps> = (\n  props: CodeTextAreaProps\n) => {\n  const { classes, value, onChange, readOnly = false } = props;\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      if (onChange) {\n        onChange(event.target.value);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      <textarea\n        readOnly={readOnly}\n        className={classes.textarea}\n        value={value}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(CodeTextArea);\n","import React, { RefObject } from \"react\";\n\nimport \"./ProseMirror.scss\";\n\nimport { WithStyles, withStyles } from \"@material-ui/core\";\n\n// tslint:disable-next-line\nconst EditorState = require(\"prosemirror-state\").EditorState;\n// tslint:disable-next-line\nconst EditorView = require(\"prosemirror-view\").EditorView;\n// tslint:disable-next-line\nconst exampleSetup = require(\"prosemirror-example-setup\").exampleSetup;\n// tslint:disable-next-line\nconst { tableEditing, columnResizing } = require(\"prosemirror-tables\");\n// tslint:disable-next-line\nconst keymap = require(\"prosemirror-keymap\").keymap;\n// tslint:disable-next-line\nconst { sinkListItem, liftOutOfList } = require(\"prosemirror-schema-list\");\n// tslint:disable-next-line\nconst { undoInputRule } = require(\"prosemirror-inputrules\");\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    minHeight: 250,\n    maxHeight: 600,\n    overflowY: \"scroll\" as \"scroll\"\n  }\n};\n\nexport interface ProseMirrorProps extends WithStyles<typeof styles> {\n  schema: any;\n  doc?: any;\n  editorViewOptions?: any;\n  onUpdateState?: (state: any, editorView: any) => void;\n  onChange?: (doc: any) => void;\n}\n\ninterface ProseMirrorState {\n  ref: RefObject<any>;\n  editorView?: any;\n}\n\nfunction getKeys(schema: any): any {\n  return {\n    Tab: sinkListItem(schema.nodes.list_item),\n    Backspace: (state: any, dispatch: any, range: any): boolean => {\n      debugger;\n      if (!liftOutOfList(state, dispatch, range)) {\n        return undoInputRule(state, dispatch, range);\n      }\n      return true;\n    }\n  }\n}\n\nclass ProseMirror extends React.Component<ProseMirrorProps, ProseMirrorState> {\n  constructor(props: ProseMirrorProps) {\n    super(props);\n    const ref = React.createRef();\n    this.state = { ref };\n  }\n\n  public createEditorState(): any {\n    const { schema, doc } = this.props;\n\n    const withTablePlugins = schema.nodes.table != null;\n    const tablePlugins = withTablePlugins ? [ columnResizing(), tableEditing() ] : [];\n\n    return EditorState.create({\n      schema,\n      doc,\n      plugins: [\n        ...tablePlugins,\n        keymap(getKeys(schema)),\n        ...exampleSetup({ schema, menuBar: false }), // can pass mapkeys to suppress some bindings\n      ]\n    });\n  }\n\n  public createEditorView(parent: any): any {\n    const { onUpdateState, onChange } = this.props;\n\n    const editorState = this.createEditorState();\n\n    const view = new EditorView(parent, {\n      ...this.props.editorViewOptions,\n      state: editorState,\n      dispatchTransaction: (transaction: any) => {\n        const { state, transactions } = view.state.applyTransaction(\n          transaction\n        );\n        view.updateState(state);\n\n        if (onUpdateState) {\n          onUpdateState(state, view);\n        }\n\n        if (transactions.some((tr: any) => tr.docChanged)) {\n          if (onChange) {\n            onChange(state.doc);\n          }\n        }\n\n        this.forceUpdate();\n      }\n    });\n\n    if (onUpdateState) {\n      onUpdateState(view.state, view);\n    }\n\n    return view;\n  }\n\n  public componentDidMount(): void {\n    if (this.state.ref && !this.state.editorView) {\n      const editorView = this.createEditorView(this.state.ref.current);\n      this.setState({ editorView });\n    }\n  }\n\n  public render(): React.ReactElement {\n    const { classes } = this.props;\n    return <div className={classes.root} ref={this.state.ref} />;\n  }\n}\n\nexport default withStyles(styles)(ProseMirror);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\n\nconst styles = {\n  root: {\n    display: \"flex\"\n  },\n  button: {\n    outline: \"none\" as \"none\",\n    transition: \"color 0.2s linear,border-bottom-color 0.2s linear\",\n    height: 40,\n    cursor: \"pointer\" as \"pointer\",\n    background: \"transparent\" as \"transparent\",\n    border: \"0 solid transparent\",\n    borderTop: \"3px solid transparent\",\n    borderBottom: \"3px solid transparent\",\n    fontSize: 13,\n    padding: \"0 15px\",\n    color: \"#999999\",\n    fontWeight: \"bold\" as \"bold\"\n  },\n  selected: {\n    color: \"#1EA7FD\",\n    borderBottomColor: \"#1EA7FD\"\n  }\n};\n\nexport interface ViewSwitcherProps extends WithStyles<typeof styles> {\n  disableCodeView?: boolean;\n  disableEditView?: boolean;\n\n  language?: string;\n  onChange?: (view: EditorView) => void;\n}\n\nexport enum EditorView {\n  EDIT = \"edit\",\n  CODE = \"code\"\n}\n\nconst ViewSwitcher = (props: ViewSwitcherProps) => {\n  const {\n    classes,\n    onChange,\n    language,\n    disableCodeView,\n    disableEditView\n  } = props;\n\n  const [selectedView, setSelectedView] = React.useState(\n    !disableEditView ? EditorView.EDIT : EditorView.CODE\n  );\n\n  const handleChange = React.useCallback(\n    (view: EditorView) => {\n      setSelectedView(view);\n      if (onChange) {\n        onChange(view);\n      }\n    },\n    [setSelectedView]\n  );\n\n  const renderButton = React.useCallback(\n    (label: string, view: EditorView) => {\n      return (\n        <button\n          onClick={() => handleChange(view)}\n          className={clsx(classes.button, {\n            [classes.selected]: selectedView === view\n          })}\n          type=\"button\"\n          role=\"tab\"\n        >\n          {label}\n        </button>\n      );\n    },\n    [selectedView, handleChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      {disableEditView ? false : renderButton(\"Edit\", EditorView.EDIT)}\n      {disableCodeView\n        ? false\n        : renderButton(language || \"Code\", EditorView.CODE)}\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ViewSwitcher);\n","export var RichLanguageFormat;\n\n(function (RichLanguageFormat) {\n  RichLanguageFormat[\"TEXT\"] = \"text\";\n  RichLanguageFormat[\"JSON\"] = \"json\";\n})(RichLanguageFormat || (RichLanguageFormat = {}));","export function inBlock(state) {\n  var $from = state.selection.$from;\n  return $from.depth > 1;\n}\nexport function isMarkActive(state, type) {\n  var _a = state.selection,\n      from = _a.from,\n      $from = _a.$from,\n      to = _a.to,\n      empty = _a.empty;\n\n  if (empty) {\n    return type.isInSet(state.storedMarks || $from.marks());\n  } else {\n    return state.doc.rangeHasMark(from, to, type);\n  }\n}\nexport function getSelectionMarks(state) {\n  var _a = state.selection,\n      $from = _a.$from,\n      $to = _a.$to;\n  var currentMarks = [];\n  state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\n    node.marks.forEach(function (mark) {\n      return currentMarks.push({\n        from: start,\n        to: start + node.nodeSize,\n        mark: mark\n      });\n    });\n  });\n  return currentMarks;\n}\nexport function hasMarkup(state, type, atts) {\n  var _a = state.selection,\n      $from = _a.$from,\n      to = _a.to,\n      node = _a.node;\n\n  if (node) {\n    return node.hasMarkup(type, atts);\n  }\n\n  return to <= $from.end() && $from.parent.hasMarkup(type, atts);\n}\nexport function canInsert(state, type) {\n  var $from = state.selection.$from;\n\n  for (var d = $from.depth; d >= 0; d--) {\n    var index = $from.index(d);\n\n    if ($from.node(d).canReplaceWith(index, index, type)) {\n      return true;\n    }\n  }\n\n  return false;\n}\nexport function clearAllMarks() {\n  return function (state, dispatch) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n\n    if (dispatch) {\n      if ($cursor) {\n        var marks = state.storedMarks || $cursor.marks();\n\n        for (var _i = 0, marks_1 = marks; _i < marks_1.length; _i++) {\n          var mark = marks_1[_i];\n          dispatch(state.tr.removeStoredMark(mark.type));\n        }\n      } else {\n        var tr = state.tr;\n\n        for (var _a = 0, ranges_1 = ranges; _a < ranges_1.length; _a++) {\n          var range = ranges_1[_a];\n\n          for (var _b = 0, _c = Object.keys(state.schema.marks); _b < _c.length; _b++) {\n            var markName = _c[_b];\n            tr.removeMark(range.$from.pos, range.$to.pos, state.schema.marks[markName]);\n          }\n        }\n\n        dispatch(tr);\n      }\n    }\n\n    return true;\n  };\n}","export function isToolEnabled(toolName, options) {\n  if (options.tools && options.tools.blacklist && options.tools.blacklist.indexOf(toolName) !== -1) {\n    return false;\n  }\n\n  if (options.tools && options.tools.whitelist && options.tools.whitelist.indexOf(toolName) === -1) {\n    return false;\n  }\n\n  return true;\n}","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport React from \"react\";\nimport { canInsert, clearAllMarks, getSelectionMarks, isMarkActive } from \"../utils\"; // tslint:disable:no-submodule-imports\n\nimport CalendarViewDay from \"@material-ui/icons/CalendarViewDay\";\nimport Code from \"@material-ui/icons/Code\";\nimport FormatBold from \"@material-ui/icons/FormatBold\";\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\nimport FormatIndentDecrease from \"@material-ui/icons/FormatIndentDecrease\";\nimport FormatItalic from \"@material-ui/icons/FormatItalic\";\nimport FormatListBulleted from \"@material-ui/icons/FormatListBulleted\";\nimport FormatListNumbered from \"@material-ui/icons/FormatListNumbered\";\nimport FormatQuote from \"@material-ui/icons/FormatQuote\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport Link from \"@material-ui/icons/Link\";\nimport Redo from \"@material-ui/icons/Redo\";\nimport Undo from \"@material-ui/icons/Undo\";\nimport { isToolEnabled } from \"./StandardToolOptions\"; // tslint:disable-next-line\n\nvar _a = require(\"prosemirror-history\"),\n    undoFn = _a.undo,\n    redoFn = _a.redo; // tslint:disable-next-line\n\n\nvar _b = require(\"prosemirror-commands\"),\n    toggleMark = _b.toggleMark,\n    setBlockType = _b.setBlockType,\n    lift = _b.lift; // tslint:disable-next-line\n\n\nvar wrapInList = require(\"prosemirror-schema-list\").wrapInList; // tslint:disable-next-line\n\n\nvar findParentNode = require(\"prosemirror-utils\").findParentNode;\n\nexport function createMarkToggleTool(name, label, icon, type) {\n  return {\n    name: name,\n    label: label,\n    displayIcon: icon,\n    isActive: function isActive(state) {\n      return isMarkActive(state, type);\n    },\n    apply: toggleMark(type)\n  };\n}\nexport function undo() {\n  return {\n    name: \"undo\",\n    label: \"Undo\",\n    displayIcon: React.createElement(Undo, null),\n    isEnabled: function isEnabled(state) {\n      return undoFn(state);\n    },\n    apply: undoFn\n  };\n}\nexport function redo() {\n  return {\n    name: \"redo\",\n    label: \"Redo\",\n    displayIcon: React.createElement(Redo, null),\n    isEnabled: function isEnabled(state) {\n      return redoFn(state);\n    },\n    apply: redoFn\n  };\n}\nexport function strong(schema) {\n  return createMarkToggleTool(\"strong\", \"Bold\", React.createElement(FormatBold, null), schema.marks.strong);\n}\nexport function em(schema) {\n  return createMarkToggleTool(\"em\", \"Italic\", React.createElement(FormatItalic, null), schema.marks.em);\n}\nexport function code(schema) {\n  return createMarkToggleTool(\"code\", \"Code\", React.createElement(Code, null), schema.marks.code);\n}\nexport function editLink(type, dialog) {\n  var _this = this;\n\n  return function (state, dispatch, view) {\n    return __awaiter(_this, void 0, void 0, function () {\n      var marks, attrs, linkValue, newAttrs, tr, selection, err_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            marks = getSelectionMarks(state).filter(function (mark) {\n              return mark.mark.type === type;\n            });\n            attrs = marks.length === 1 ? marks[0].mark.attrs : undefined;\n            if (!dialog) return [3\n            /*break*/\n            , 4];\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , dialog(attrs)];\n\n          case 2:\n            linkValue = _a.sent();\n            newAttrs = {\n              href: linkValue.href,\n              title: linkValue.title === \"\" ? undefined : linkValue.title\n            };\n\n            if (marks.length > 0 && newAttrs.href !== \"\") {\n              tr = state.tr, selection = state.selection;\n\n              if (selection.from === selection.to) {\n                dispatch(tr.addMark(marks[0].from, marks[0].to, type.create(newAttrs)));\n              } else {\n                dispatch(tr.addMark(selection.from, selection.to, type.create(newAttrs)));\n              }\n            } else {\n              toggleMark(type, newAttrs)(state, dispatch, view);\n            }\n\n            return [2\n            /*return*/\n            ];\n\n          case 3:\n            err_1 = _a.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 4:\n            if (isMarkActive(state, type)) {\n              toggleMark(type)(state, dispatch, view);\n              return [2\n              /*return*/\n              ];\n            }\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n}\nexport function link(schema, dialog) {\n  return {\n    name: \"link\",\n    label: \"Add or remove Link\",\n    displayIcon: React.createElement(Link, null),\n    isActive: function isActive(state) {\n      return isMarkActive(state, schema.marks.link);\n    },\n    isEnabled: function isEnabled(state) {\n      return !state.selection.empty || getSelectionMarks(state).filter(function (mark) {\n        return mark.mark.type === schema.marks.link;\n      }).length > 0;\n    },\n    apply: editLink(schema.marks.link, dialog)\n  };\n}\nexport function insertImage(type, dialog) {\n  var _this = this;\n\n  return function (state, dispatch, view) {\n    return __awaiter(_this, void 0, void 0, function () {\n      var imageValue, err_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!dialog) return [3\n            /*break*/\n            , 4];\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , dialog()];\n\n          case 2:\n            imageValue = _a.sent();\n            view.dispatch(view.state.tr.replaceSelectionWith(type.createAndFill({\n              src: imageValue.src,\n              title: imageValue.title === \"\" ? undefined : imageValue.title,\n              alt: imageValue.alt === \"\" ? undefined : imageValue.alt\n            })));\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            err_2 = _a.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 4:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n}\nexport function image(schema, dialog) {\n  return {\n    name: \"image\",\n    label: \"Insert Image from URL\",\n    displayIcon: React.createElement(ImageIcon, null),\n    apply: insertImage(schema.nodes.image, dialog)\n  };\n}\nexport function lift_tool(schema) {\n  return {\n    name: \"lift\",\n    label: \"Decrease Indentation\",\n    displayIcon: React.createElement(FormatIndentDecrease, null),\n    isVisible: function isVisible(state) {\n      return lift(state);\n    },\n    apply: lift\n  };\n}\nexport function bullet_list(schema) {\n  return {\n    name: \"bullet_list\",\n    label: \"Bullet List\",\n    displayIcon: React.createElement(FormatListBulleted, null),\n    isEnabled: function isEnabled(state) {\n      return wrapInList(schema.nodes.bullet_list, {})(state);\n    },\n    apply: wrapInList(schema.nodes.bullet_list, {})\n  };\n}\nexport function ordered_list(schema) {\n  return {\n    name: \"ordered_list\",\n    label: \"Ordered List\",\n    displayIcon: React.createElement(FormatListNumbered, null),\n    isEnabled: function isEnabled(state) {\n      return wrapInList(schema.nodes.ordered_list, {})(state);\n    },\n    apply: wrapInList(schema.nodes.ordered_list, {})\n  };\n}\nexport function blockquote(schema) {\n  return {\n    name: \"blockquote\",\n    label: \"Quote\",\n    displayIcon: React.createElement(FormatQuote, null),\n    isEnabled: function isEnabled(state) {\n      return wrapInList(schema.nodes.blockquote, {})(state);\n    },\n    apply: wrapInList(schema.nodes.blockquote, {})\n  };\n}\n\nfunction getCurrentAlignment(state) {\n  if (state == null) {\n    return {};\n  } // Locate the block we're contained in.\n\n\n  var parent = findParentNode(function (x) {\n    return x.attrs.align;\n  })(state.selection);\n\n  if (parent != null) {\n    return {\n      align: parent.node.attrs.align\n    };\n  } else {\n    return {};\n  }\n}\n\nfunction blockTypeCommand(state, type, attrs) {\n  return setBlockType(type, __assign(__assign({}, attrs), getCurrentAlignment(state)));\n}\n\nexport function heading(schema, level) {\n  return {\n    name: \"heading_\" + level,\n    label: \"Heading \" + level,\n    displayLabel: React.createElement(\"h\" + level, {\n      style: {\n        margin: 0\n      }\n    }, \"Heading \" + level),\n    apply: function apply(state, dispatch, view) {\n      return blockTypeCommand(state, schema.nodes.heading, {\n        level: level\n      })(state, dispatch, view);\n    },\n    isEnabled: function isEnabled(state) {\n      return blockTypeCommand(state, schema.nodes.heading, {\n        level: level\n      })(state);\n    },\n    isActive: function isActive(state, view) {\n      return !blockTypeCommand(state, schema.nodes.heading, {\n        level: level\n      })(state, null, view);\n    }\n  };\n}\nexport function paragraph(schema) {\n  var command = setBlockType(schema.nodes.paragraph);\n  return {\n    name: \"paragraph\",\n    label: \"Normal text\",\n    displayLabel: React.createElement(\"p\", {\n      style: {\n        margin: 0,\n        padding: 0,\n        display: \"inline\"\n      }\n    }, \"Normal text\"),\n    apply: function apply(state, dispatch, view) {\n      return blockTypeCommand(state, schema.nodes.paragraph)(state, dispatch, view);\n    },\n    isEnabled: function isEnabled(state) {\n      return blockTypeCommand(state, schema.nodes.paragraph)(state);\n    },\n    isActive: function isActive(state, view) {\n      return !blockTypeCommand(state, schema.nodes.paragraph)(state, null, view);\n    }\n  };\n}\nexport function code_block(schema) {\n  var command = setBlockType(schema.nodes.code_block);\n  return {\n    name: \"code_block\",\n    label: \"Code Block\",\n    displayLabel: React.createElement(\"code\", null, \"Code Block\"),\n    displayIcon: React.createElement(Code, null),\n    apply: command,\n    isEnabled: function isEnabled(state) {\n      return command(state);\n    },\n    isActive: function isActive(state, view) {\n      return !command(state, null, view);\n    }\n  };\n}\nexport function horizontal_rule(schema) {\n  return {\n    name: \"horizontal_rule\",\n    label: \"Insert Horizontal Rule\",\n    displayIcon: React.createElement(CalendarViewDay, null),\n    apply: function apply(state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\n    },\n    isEnabled: function isEnabled(state) {\n      return canInsert(state, schema.nodes.horizontal_rule);\n    }\n  };\n}\nexport function clear_formatting() {\n  return {\n    name: \"clear_formatting\",\n    label: \"Clear Formatting\",\n    displayIcon: React.createElement(FormatClearIcon, null),\n    apply: clearAllMarks(),\n    isEnabled: function isEnabled(state) {\n      // are there any marks?\n      return true;\n    }\n  };\n}\nexport function createStandardTools(schema, options) {\n  var tools = [];\n\n  if (isToolEnabled('undo', options)) {\n    tools.push(undo());\n  }\n\n  if (isToolEnabled('redo', options)) {\n    tools.push(redo());\n  }\n\n  if (isToolEnabled('strong', options) && schema.marks.strong) {\n    tools.push(strong(schema));\n  }\n\n  if (isToolEnabled('em', options) && schema.marks.em) {\n    tools.push(em(schema));\n  }\n\n  if (isToolEnabled('code', options) && schema.marks.code) {\n    tools.push(code(schema));\n  }\n\n  if (isToolEnabled('link', options) && schema.marks.link) {\n    tools.push(link(schema, options.dialogs ? options.dialogs.getHyperlink : undefined));\n  }\n\n  if (isToolEnabled('lift', options)) {\n    tools.push(lift_tool(schema));\n  }\n\n  if (isToolEnabled('bullet_list', options) && schema.nodes.bullet_list) {\n    tools.push(bullet_list(schema));\n  }\n\n  if (isToolEnabled('ordered_list', options) && schema.nodes.ordered_list) {\n    tools.push(ordered_list(schema));\n  }\n\n  if (isToolEnabled('image', options) && schema.nodes.image) {\n    tools.push(image(schema, options.dialogs ? options.dialogs.getImage : undefined));\n  }\n\n  if (isToolEnabled('blockquote', options) && schema.nodes.blockquote) {\n    tools.push(blockquote(schema));\n  }\n\n  if (isToolEnabled('heading', options) && schema.nodes.heading) {\n    for (var i = 1; i < 7; i++) {\n      tools.push(heading(schema, i));\n    }\n  }\n\n  if (isToolEnabled('paragraph', options) && schema.nodes.paragraph) {\n    tools.push(paragraph(schema));\n  }\n\n  if (isToolEnabled('code_block', options) && schema.nodes.code_block) {\n    tools.push(code_block(schema));\n  }\n\n  if (isToolEnabled('horizontal_rule', options) && schema.nodes.horizontal_rule) {\n    tools.push(horizontal_rule(schema));\n  }\n\n  if (isToolEnabled('clear_formatting', options)) {\n    tools.push(clear_formatting());\n  }\n\n  return tools;\n}","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { FormatAlignCenter, FormatAlignJustify, FormatAlignLeft, FormatAlignRight } from \"@material-ui/icons\";\nimport React from \"react\";\n\nfunction getContainingTextBlocks(state) {\n  var resultNodes = new Set();\n  var result = [];\n  state.doc.nodesBetween(state.selection.from, state.selection.to, function (node, pos, parent, index) {\n    if (node.isTextblock && !resultNodes.has(node)) {\n      result.push({\n        node: node,\n        pos: pos,\n        start: 0,\n        depth: 0\n      });\n      resultNodes.add(node);\n    }\n  });\n  return Array.from(result);\n}\n\nfunction align(state, dispatch, alignment) {\n  // Apply align attr to the text block.\n  var result = getContainingTextBlocks(state);\n  var tr = state.tr;\n  result.forEach(function (item) {\n    var node = item.node,\n        pos = item.pos;\n    tr = tr.setNodeMarkup(pos, node.type, __assign(__assign({}, node.attrs), {\n      align: alignment\n    }));\n  });\n\n  if (dispatch) {\n    dispatch(tr);\n  }\n\n  return true;\n}\n\nfunction alignActive(state, view, alignment) {\n  // Apply align attr to the text block.\n  var result = getContainingTextBlocks(state);\n  var anyMismatch = false;\n  result.forEach(function (item) {\n    if ((result[0].node.attrs.align || \"left\") !== alignment) {\n      anyMismatch = true;\n    }\n  });\n\n  if (result.length === 0) {\n    return false;\n  }\n\n  return !anyMismatch;\n}\n\nfunction alignable(state, view) {\n  // Any text block is alignable.\n  return getContainingTextBlocks(state).length > 0;\n}\n\nexport function AlignLeftTool(schema) {\n  return {\n    name: \"align_left\",\n    label: \"Align Left\",\n    displayIcon: React.createElement(FormatAlignLeft, null),\n    apply: function apply(state, dispatch) {\n      return align(state, dispatch, \"left\");\n    },\n    isActive: function isActive(state, view) {\n      return alignActive(state, view, \"left\");\n    },\n    isVisible: alignable\n  };\n}\nexport function AlignCenterTool(schema) {\n  return {\n    name: \"align_center\",\n    label: \"Align center\",\n    displayIcon: React.createElement(FormatAlignCenter, null),\n    apply: function apply(state, dispatch) {\n      return align(state, dispatch, \"center\");\n    },\n    isActive: function isActive(state, view) {\n      return alignActive(state, view, \"center\");\n    },\n    isVisible: alignable\n  };\n}\nexport function AlignRightTool(schema) {\n  return {\n    name: \"align_right\",\n    label: \"Align Right\",\n    displayIcon: React.createElement(FormatAlignRight, null),\n    apply: function apply(state, dispatch) {\n      return align(state, dispatch, \"right\");\n    },\n    isActive: function isActive(state, view) {\n      return alignActive(state, view, \"right\");\n    },\n    isVisible: alignable\n  };\n}\nexport function AlignJustifyTool(schema) {\n  return {\n    name: \"align_justify\",\n    label: \"Align Justify\",\n    displayIcon: React.createElement(FormatAlignJustify, null),\n    apply: function apply(state, dispatch) {\n      return align(state, dispatch, \"justify\");\n    },\n    isActive: function isActive(state, view) {\n      return alignActive(state, view, \"justify\");\n    },\n    isVisible: alignable\n  };\n}","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\n// tslint:disable-next-line\nexport var anchor = {\n  group: \"inline\",\n  inline: true,\n  attrs: {\n    value: {}\n  },\n  parseDOM: [{\n    tag: \"a[id]\",\n    getAttrs: function getAttrs(dom) {\n      var value = JSON.parse(dom.getAttribute(\"id\"));\n      return {\n        value: value\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    var value = node.attrs.value;\n    return [\"a\", {\n      \"id\": JSON.stringify(value)\n    }, value];\n  }\n};","var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport { canInsert } from \"@dc-extension-rich-text/common\";\nimport Directions from \"@material-ui/icons/Directions\";\nimport React from \"react\";\nexport function AnchorTool(schema, dialog) {\n  return {\n    name: \"anchor\",\n    label: \"Insert Anchor\",\n    displayIcon: React.createElement(Directions, null),\n    apply: insertAnchor(schema.nodes.anchor, dialog),\n    isEnabled: function isEnabled(state) {\n      return canInsert(state, schema.nodes.anchor);\n    }\n  };\n}\nexport function insertAnchor(type, dialog) {\n  var _this = this;\n\n  return function (state, dispatch, view) {\n    return __awaiter(_this, void 0, void 0, function () {\n      var anchorValue, err_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!dialog) return [3\n            /*break*/\n            , 4];\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n\n            return [4\n            /*yield*/\n            , dialog()];\n\n          case 2:\n            anchorValue = _a.sent();\n            view.dispatch(view.state.tr.replaceSelectionWith(type.createAndFill({\n              value: anchorValue.value\n            })));\n            return [3\n            /*break*/\n            , 4];\n\n          case 3:\n            err_1 = _a.sent();\n            return [3\n            /*break*/\n            , 4];\n\n          case 4:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n}","export var AnchorToMarkdown = {\n  anchor: function anchor(state, node) {\n    var attrs = {};\n\n    if (node.attrs.value) {\n      attrs.id = node.attrs.value;\n    }\n\n    var attrsSerialized = Object.keys(attrs).map(function (key) {\n      return key + \"=\\\"\" + attrs[key] + \"\\\"\";\n    }).join(\" \");\n    state.write(\"<a \" + attrsSerialized + \"></a>\");\n  }\n};","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n}; // tslint:disable-next-line\n\n\nexport var inline_styles = {\n  attrs: {\n    class: {\n      default: \"\"\n    },\n    style: {\n      default: \"\"\n    }\n  },\n  group: \"inline\",\n  parseDOM: [{\n    tag: \"span\",\n    getAttrs: function getAttrs(node) {\n      return {\n        class: node.getAttribute(\"class\"),\n        style: node.attributes.style.value\n      };\n    }\n  }],\n  toDOM: function toDOM(mark) {\n    return [\"span\", __assign(__assign({}, mark.attrs.style ? {\n      style: mark.attrs.style\n    } : {}), {\n      class: mark && mark.attrs && mark.attrs.class ? mark.attrs.class : \"\"\n    }), 0];\n  }\n};","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction rangeHasFilteredMark(doc, from, to, type, filter) {\n  var found = false;\n\n  if (to > from) {\n    doc.nodesBetween(from, to, function (node) {\n      if (type.isInSet(node.marks) && node.marks.filter(filter).length > 0) {\n        found = true;\n      }\n\n      return !found;\n    });\n  }\n\n  return found;\n}\n\nexport function isFilteredMarkActive(state, type, filter) {\n  var _a = state.selection,\n      from = _a.from,\n      $from = _a.$from,\n      to = _a.to,\n      empty = _a.empty;\n\n  if (empty) {\n    if (!type.isInSet(state.storedMarks || $from.marks())) {\n      return false;\n    }\n\n    var validMarks = (state.storedMarks || $from.marks()).filter(filter);\n    return validMarks.length > 0;\n  } else {\n    return rangeHasFilteredMark(state.doc, from, to, type, filter);\n  }\n}\n\nfunction getMarkFromRange(state, from, to, markType) {\n  var result;\n\n  if (to > from) {\n    state.doc.nodesBetween(from, to, function (node) {\n      if (markType.isInSet(node.marks)) {\n        result = node.marks.find(function (x) {\n          return x.type === markType;\n        });\n        return false;\n      }\n\n      return true;\n    });\n  }\n\n  return result;\n}\n\nfunction getStoredMark(state, markType) {\n  var ref = state.selection;\n  var $cursor = ref.$cursor;\n\n  if ($cursor) {\n    return (state.storedMarks || $cursor.marks()).find(function (x) {\n      return x.type === markType;\n    });\n  }\n}\n\nfunction mergeAttrs(oldAttrs, newAttrs) {\n  return __assign(__assign({}, oldAttrs), newAttrs);\n}\n\nexport function setMarkAttributes(markType, attrs) {\n  return function (state, dispatch) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    var ranges = ref.ranges;\n\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks())) {\n          var existingMark = getStoredMark(state, markType);\n          dispatch(state.tr.removeStoredMark(markType));\n\n          if (existingMark) {\n            dispatch(state.tr.addStoredMark(markType.create(mergeAttrs(existingMark.attrs, attrs))));\n          }\n        } else {\n          dispatch(state.tr.addStoredMark(markType.create(attrs)));\n        }\n      } else {\n        var has = false;\n        var tr = state.tr;\n\n        for (var i = 0; !has && i < ranges.length; i++) {\n          var ref$1 = ranges[i];\n          var $from = ref$1.$from;\n          var $to = ref$1.$to;\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n        }\n\n        for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\n          var ref$2 = ranges_1[_i];\n          var $from$1 = ref$2.$from;\n          var $to$1 = ref$2.$to;\n\n          if (has) {\n            var markAttrs = __assign({}, getMarkFromRange(state, $from$1.pos, $to$1.pos, markType).attrs);\n\n            tr.removeMark($from$1.pos, $to$1.pos, markType);\n            tr.addMark($from$1.pos, $to$1.pos, markType.create(mergeAttrs(markAttrs, attrs)));\n          } else {\n            tr.addMark($from$1.pos, $to$1.pos, markType.create(attrs));\n          }\n        }\n\n        dispatch(tr.scrollIntoView());\n      }\n    }\n\n    return true;\n  };\n}","import { isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport React from 'react';\nimport { isFilteredMarkActive, setMarkAttributes } from \"../utils/MarkUtils\";\nexport function inlineStyleClassNameTool(schema, className, classLabel) {\n  var mark = schema.marks.inline_styles;\n  return {\n    name: \"inline_styles_className_\" + className,\n    label: classLabel,\n    displayLabel: React.createElement(\"span\", {\n      className: className\n    }, classLabel),\n    apply: setMarkAttributes(mark, {\n      class: className\n    }),\n    isEnabled: function isEnabled(state) {\n      return true;\n    },\n    isActive: function isActive(state) {\n      return isFilteredMarkActive(state, mark, function (m) {\n        return m.attrs.class === className;\n      });\n    }\n  };\n}\nexport function createInlineStylesTools(schema, options) {\n  var tools = [];\n\n  if (schema.marks.inline_styles && isToolEnabled('inline_styles', options) && options.tools && options.tools.inline_styles) {\n    var inlineStylesOptions = options.tools.inline_styles;\n\n    if (inlineStylesOptions.classNames) {\n      for (var _i = 0, _a = inlineStylesOptions.classNames; _i < _a.length; _i++) {\n        var className = _a[_i];\n        tools.push(inlineStyleClassNameTool(schema, className.className, className.label));\n      }\n    }\n  }\n\n  return tools;\n}","export var InlineStylesToMarkdown = {\n  inline_styles: {\n    open: function open(state, mark, parent, index) {\n      var attrs = {};\n\n      if (mark.attrs.class) {\n        attrs.class = mark.attrs.class;\n      }\n\n      var attrsSerialized = Object.keys(attrs).map(function (key) {\n        return key + \"=\\\"\" + attrs[key] + \"\\\"\";\n      }).join(\" \");\n\n      if (attrsSerialized.length > 0) {\n        return \"<span \" + attrsSerialized + \">\";\n      } else {\n        return \"<span>\";\n      }\n    },\n    close: \"</span>\"\n  }\n};","// HTML block\n'use strict';\n\nvar blockNames = ['address', 'article', 'aside', 'base', 'basefont', 'blockquote', 'body', 'caption', 'center', 'col', 'colgroup', 'dd', 'details', 'dialog', 'dir', 'div', 'dl', 'dt', 'fieldset', 'figcaption', 'figure', 'footer', 'form', 'frame', 'frameset', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hr', 'html', 'iframe', 'legend', 'li', 'link', 'main', 'menu', 'menuitem', 'meta', 'nav', 'noframes', 'ol', 'optgroup', 'option', 'p', 'param', 'section', 'source', 'summary', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'title', 'tr', 'track', 'ul'];\nvar attrName = '[a-zA-Z_:][a-zA-Z0-9:._-]*';\nvar unquoted = '[^\"\\'=<>`\\\\x00-\\\\x20]+';\nvar singleQuoted = \"'[^']*'\";\nvar doubleQuoted = '\"[^\"]*\"';\nvar attrValue = '(?:' + unquoted + '|' + singleQuoted + '|' + doubleQuoted + ')';\nvar attribute = '(?:\\\\s+' + attrName + '(?:\\\\s*=\\\\s*' + attrValue + ')?)';\nvar openTag = '<[A-Za-z][A-Za-z0-9\\\\-]*' + attribute + '*\\\\s*\\\\/?>';\nvar closeTag = '<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>';\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp('^(?:' + openTag + '|' + closeTag + ')'); // An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\n\nvar HTML_SEQUENCES = [[/^<(script|pre|style)(?=(\\s|>|$))/i, /<\\/(script|pre|style)>/i, true], [/^<!--/, /-->/, true], [/^<\\?/, /\\?>/, true], [/^<![A-Z]/, />/, true], [/^<!\\[CDATA\\[/, /\\]\\]>/, true], [new RegExp('^</?(' + blockNames.join('|') + ')(?=(\\\\s|/?>|$))', 'i'), /^$/, true], [new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + '\\\\s*$'), /^$/, false]];\nexport function html_block(state, startLine, endLine, silent) {\n  var i;\n  var nextLine;\n  var token;\n  var lineText;\n  var pos = state.bMarks[startLine] + state.tShift[startLine];\n  var max = state.eMarks[startLine]; // if it's indented more than 3 spaces, it should be a code block\n\n  if (state.sCount[startLine] - state.blkIndent >= 4) {\n    return false;\n  }\n\n  if (!state.md.options.html) {\n    return false;\n  }\n\n  if (state.src.charCodeAt(pos) !== 0x3C\n  /* < */\n  ) {\n      return false;\n    }\n\n  lineText = state.src.slice(pos, max);\n\n  for (i = 0; i < HTML_SEQUENCES.length; i++) {\n    if (HTML_SEQUENCES[i][0].test(lineText)) {\n      break;\n    }\n  }\n\n  if (i === HTML_SEQUENCES.length) {\n    return false;\n  }\n\n  if (silent) {\n    // true if this sequence can be a terminator, false otherwise\n    return HTML_SEQUENCES[i][2];\n  }\n\n  nextLine = startLine + 1; // If we are here - we detected HTML block.\n  // Let's roll down till block end.\n\n  if (!HTML_SEQUENCES[i][1].test(lineText)) {\n    for (; nextLine < endLine; nextLine++) {\n      if (state.sCount[nextLine] < state.blkIndent) {\n        break;\n      }\n\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n      lineText = state.src.slice(pos, max);\n\n      if (HTML_SEQUENCES[i][1].test(lineText)) {\n        if (lineText.length !== 0) {\n          nextLine++;\n        }\n\n        break;\n      }\n    }\n  }\n\n  var content = state.getLines(startLine, nextLine, state.blkIndent, true);\n  var dom = new DOMParser().parseFromString(content, \"text/html\");\n  var tag = dom.body.firstChild;\n  var innerContent = tag == null ? '' : tag.innerHTML;\n  state.line = nextLine;\n  token = state.push('html_block_open', '', 1);\n  token.meta = {\n    tag: tag.tagName,\n    attrs: Array.from(tag.attributes)\n  };\n  token.map = [startLine, state.line];\n  token = state.push('inline', '', 0);\n  token.map = [startLine, nextLine];\n  token.content = innerContent;\n  token.children = [];\n  token = state.push('html_block_close', '', -1);\n  token.meta = {\n    tag: tag.tagName\n  };\n  return true;\n}\n;","// Process &shy;\nexport function soft_hyphen_from(state, silent) {\n  var pos = state.pos;\n\n  if (state.src.slice(pos, pos + 5) !== \"&shy;\") {\n    return false;\n  }\n\n  if (!silent) {\n    var content = state.src.slice(pos, pos + 5);\n    var token = state.push('soft_hyphen', 'shy', 0);\n    token.attrs = [];\n    token.content = content;\n  }\n\n  state.pos = pos + 5;\n  return true;\n}\n;","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\n// tslint:disable-next-line\nexport var soft_hyphen = {\n  group: \"inline\",\n  inline: true,\n  parseDOM: [{\n    tag: \"span[data-shy]\",\n    getAttrs: function getAttrs(dom) {\n      return {};\n    }\n  }],\n  toDOM: function toDOM(node) {\n    return [\"span\", {\n      \"data-shy\": true\n    }, \"-\"];\n  }\n};","export var SoftHyphenToMarkdown = {\n  soft_hyphen: function soft_hyphen(state, node) {\n    state.write(\"&shy;\");\n  }\n};","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { html_block } from \"../alignment\";\nimport { soft_hyphen_from } from \"../soft_hyphen\"; // tslint:disable-next-line\n\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar markdownit = require(\"markdown-it\"); // tslint:disable-next-line\n\n\nvar markdownItTable = require('markdown-it-table').markdownItTable;\n\nexport function createMarkdownParser(schema) {\n  var md = markdownit(\"commonmark\", {\n    html: true\n  });\n  md.use(markdownItTable);\n  md.inline.ruler.before(\"text\", \"soft_hyphen\", soft_hyphen_from);\n  md.block.ruler.before(\"html_block\", \"html_block\", html_block); // Patch parser to detect <span></span> tags and convert into inline_styles marks\n  // Warning... this might be a little brittle\n\n  var parser = new markdown.MarkdownParser(schema, md, __assign(__assign({}, markdown.defaultMarkdownParser.tokens), {\n    anchor: {\n      node: \"anchor\",\n      getAttrs: function getAttrs(tok) {\n        return {\n          value: tok.attrGet(\"value\")\n        };\n      }\n    },\n    soft_hyphen: {\n      node: \"soft_hyphen\"\n    },\n    table: {\n      block: \"table\"\n    },\n    th: {\n      block: \"table_header\",\n      getAttrs: function getAttrs(tok) {\n        return {\n          style: tok.attrGet(\"style\")\n        };\n      }\n    },\n    tr: {\n      block: \"table_row\"\n    },\n    td: {\n      block: \"table_cell\",\n      getAttrs: function getAttrs(tok) {\n        return {\n          style: tok.attrGet(\"style\")\n        };\n      }\n    }\n  }));\n\n  parser.tokenHandlers.html_inline = function (state, token) {\n    if (!token || !token.content) {\n      return;\n    }\n\n    var content = (token.content || \"\").trim();\n\n    if (content.startsWith(\"<span\") && content.endsWith(\">\")) {\n      var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n      var tag = dom.body.firstChild;\n\n      if (!tag) {\n        return;\n      }\n\n      if (tag.nodeName.toLowerCase() === \"span\") {\n        var className = tag.getAttribute(\"class\");\n        state.openMark(schema.marks.inline_styles.create({\n          class: className\n        }));\n      }\n    } else if (content === \"</span>\") {\n      state.closeMark(schema.marks.inline_styles);\n    } else if (content.startsWith(\"<a\") && content.endsWith(\">\")) {\n      var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n      var tag = dom.body.firstChild;\n\n      if (!tag) {\n        return;\n      }\n\n      if (tag.nodeName.toLowerCase() === \"a\") {\n        var id = tag.getAttribute(\"id\");\n        state.addNode(schema.nodes.anchor, {\n          value: id\n        });\n      }\n    } else if (content === \"<br>\") {\n      state.addNode(schema.nodes.hard_break);\n    }\n  };\n\n  var alignedParagraphTypes = new Map([[\"P\", \"paragraph\"], [\"H1\", \"heading\"], [\"H2\", \"heading\"], [\"H3\", \"heading\"], [\"H4\", \"heading\"], [\"H5\", \"heading\"], [\"H6\", \"heading\"]]); // tslint:disable-next-line\n\n  parser.tokenHandlers.html_block_open = function (state, token) {\n    if (!alignedParagraphTypes.has(token.meta.tag)) {\n      return;\n    }\n\n    var alignAttr = token.meta.attrs.find(function (x) {\n      return x.name === \"align\";\n    });\n    var nodeType = alignedParagraphTypes.get(token.meta.tag);\n    var level = nodeType === 'heading' ? Number(token.meta.tag[1]) : undefined;\n    state.openNode(schema.nodes[nodeType], {\n      align: alignAttr ? alignAttr.value : 'left',\n      level: level\n    });\n  }; // tslint:disable-next-line\n\n\n  parser.tokenHandlers.html_block_close = function (state, token) {\n    if (alignedParagraphTypes.has(token.meta.tag)) {\n      state.closeNode();\n    }\n  };\n\n  return parser;\n}","// tslint:disable-next-line\nexport var paragraph_align = {\n  content: \"inline*\",\n  attrs: {\n    align: {\n      default: \"left\"\n    }\n  },\n  group: \"block\",\n  parseDOM: [{\n    tag: \"p\",\n    getAttrs: function getAttrs(dom) {\n      return {\n        align: dom.getAttribute(\"align\")\n      };\n    }\n  }],\n  toDOM: function toDOM(node) {\n    return [\"p\", {\n      align: node.attrs.align || \"left\"\n    }, 0];\n  }\n};\n\nfunction getHeadingAttrs(level) {\n  return function getAttrs(dom) {\n    return {\n      align: dom.getAttribute(\"align\"),\n      level: level\n    };\n  };\n} // tslint:disable-next-line\n\n\nexport var heading_align = {\n  attrs: {\n    level: {\n      default: 1\n    },\n    align: {\n      default: \"left\"\n    }\n  },\n  content: \"inline*\",\n  group: \"block\",\n  defining: true,\n  parseDOM: [{\n    tag: \"h1\",\n    getAttrs: getHeadingAttrs(1)\n  }, {\n    tag: \"h2\",\n    getAttrs: getHeadingAttrs(2)\n  }, {\n    tag: \"h3\",\n    getAttrs: getHeadingAttrs(3)\n  }, {\n    tag: \"h4\",\n    getAttrs: getHeadingAttrs(4)\n  }, {\n    tag: \"h5\",\n    getAttrs: getHeadingAttrs(5)\n  }, {\n    tag: \"h6\",\n    getAttrs: getHeadingAttrs(6)\n  }],\n  toDOM: function toDOM(node) {\n    return [\"h\" + node.attrs.level, {\n      align: node.attrs.align || \"left\"\n    }, 0];\n  }\n};\nexport var AlignedParagraphToMarkdown = {\n  paragraph: function paragraph(state, node) {\n    if (node.attrs.align && node.attrs.align !== \"left\") {\n      // Aligned paragraph\n      // Emit paragraph as HTML with the align attribute.\n      state.write(\"<p align=\\\"\" + node.attrs.align + \"\\\">\");\n      state.renderInline(node);\n      state.write(\"</p>\");\n      state.closeBlock(node);\n    } else {\n      state.renderInline(node);\n      state.closeBlock(node);\n    }\n  }\n};\nexport var AlignedHeaderToMarkdown = {\n  heading: function heading(state, node) {\n    if (node.attrs.align && node.attrs.align !== \"left\") {\n      // Aligned header\n      // Emit header as HTML with the align attribute.\n      state.write(\"<h\" + node.attrs.level + \" align=\\\"\" + node.attrs.align + \"\\\">\");\n      state.renderInline(node);\n      state.write(\"</h\" + node.attrs.level + \">\");\n      state.closeBlock(node);\n    } else {\n      state.write(state.repeat(\"#\", node.attrs.level) + \" \");\n      state.renderInline(node);\n      state.closeBlock(node);\n    }\n  }\n};","var defaultRowWidth = 8;\n\nfunction tableRemoveNewlines(input) {\n  return input.trimEnd().replace(/\\\\?\\n/g, '<br>').padEnd(defaultRowWidth, ' ');\n}\n\nfunction withTableEscapes(state, action) {\n  var start = state.out.length;\n  action();\n  state.out = state.out.substr(0, start) + tableRemoveNewlines(state.out.substr(start));\n  state.closed = false;\n}\n\nexport var TableToMarkdown = {\n  table: function table(state, node) {\n    var rows = [];\n\n    for (var i = 0; i < node.childCount; i++) {\n      var child = node.maybeChild(i);\n\n      if (child != null && child.type.name === 'table_row') {\n        rows.push(child);\n      }\n    }\n\n    if (rows.length === 0) {\n      return;\n    } // First row is the header row. Get column count, and draw it.\n\n\n    state.render(rows[0]);\n    var columnCount = rows[0].childCount; // Assumes first row is header.\n    // Draw divider using the number of columns.\n\n    state.write('\\n');\n\n    for (var i = 0; i < columnCount; i++) {\n      state.write('|----------');\n    }\n\n    state.write('|'); // Second row onwards are regular rows.\n\n    for (var i = 1; i < rows.length; i++) {\n      state.write('\\n');\n      state.render(rows[i]);\n    }\n\n    state.closeBlock(node);\n  },\n  table_row: function table_row(state, node) {\n    state.write('| ');\n\n    var _loop_1 = function _loop_1(i) {\n      var child = node.maybeChild(i);\n\n      if (child != null) {\n        if (i > 0) {\n          state.write(' | ');\n        }\n\n        withTableEscapes(state, function () {\n          state.renderInline(child);\n        });\n      }\n    };\n\n    for (var i = 0; i < node.childCount; i++) {\n      _loop_1(i);\n    }\n\n    state.write(' |');\n  },\n  table_cell: function table_cell(state, node) {\n    state.renderInline(node);\n  },\n  table_header: function table_header(state, node) {\n    state.renderInline(node);\n  }\n};","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { AlignedHeaderToMarkdown, AlignedParagraphToMarkdown } from \"../alignment/AlignmentPlugin\";\nimport { AnchorToMarkdown } from \"../anchor\";\nimport { InlineStylesToMarkdown } from \"../inline_styles\";\nimport { SoftHyphenToMarkdown } from \"../soft_hyphen\";\nimport { TableToMarkdown } from \"../tables/TableToMarkdown\"; // tslint:disable-next-line\n\nvar markdown = require(\"prosemirror-markdown\");\n\nexport function createMarkdownSerializer() {\n  return new markdown.MarkdownSerializer(__assign(__assign(__assign(__assign(__assign(__assign({}, markdown.defaultMarkdownSerializer.nodes), SoftHyphenToMarkdown), AnchorToMarkdown), TableToMarkdown), AlignedParagraphToMarkdown), AlignedHeaderToMarkdown), __assign(__assign({}, markdown.defaultMarkdownSerializer.marks), InlineStylesToMarkdown));\n}","import { heading_align, paragraph_align } from \"../alignment/AlignmentPlugin\";\nimport { anchor } from \"../anchor\";\nimport { inline_styles } from \"../inline_styles\";\nimport { createMarkdownParser } from \"../markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"../markdown/MarkdownSerializer\";\nimport { soft_hyphen } from \"../soft_hyphen\"; // tslint:disable-next-line\n\nvar tableNodes = require(\"prosemirror-tables\").tableNodes; // tslint:disable-next-line\n\n\nvar Schema = require(\"prosemirror-model\").Schema;\n\nexport function createSchema(isInlineStylesEnabled) {\n  if (isInlineStylesEnabled === void 0) {\n    isInlineStylesEnabled = false;\n  }\n\n  var schema = require(\"prosemirror-markdown\").schema; // TODO: don't register nodes and marks that are disabled in the options\n\n\n  var marks = schema.spec.marks;\n\n  if (isInlineStylesEnabled) {\n    marks = marks.addToEnd(\"inline_styles\", inline_styles);\n  }\n\n  var nodes = schema.spec.nodes.append(tableNodes({\n    tableGroup: \"block\",\n    cellContent: \"block\",\n    cellAttributes: {\n      background: {\n        default: null,\n        // tslint:disable-next-line\n        getFromDOM: function getFromDOM(dom) {\n          return dom.style.backgroundColor || null;\n        },\n        // tslint:disable-next-line\n        setDOMAttr: function setDOMAttr(value, attrs) {\n          if (value) attrs.style = (attrs.style || \"\") + (\"background-color: \" + value + \";\");\n        }\n      }\n    }\n  })).addToEnd(\"soft_hyphen\", soft_hyphen).addToEnd(\"anchor\", anchor).update(\"paragraph\", paragraph_align).update(\"heading\", heading_align);\n  return new Schema({\n    nodes: nodes,\n    marks: marks\n  });\n}\nvar serializer;\nvar parser;\nexport function getDefaultSerializerParser(schema) {\n  if (serializer == null) {\n    serializer = createMarkdownSerializer();\n    parser = createMarkdownParser(schema);\n  }\n\n  return [serializer, parser];\n}","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport { BorderClear, FirstPage, LastPage, VerticalAlignBottom, VerticalAlignTop } from \"@material-ui/icons\";\nimport TableChart from \"@material-ui/icons/TableChart\";\nimport { addColumnAfter, addRowAfter, deleteColumn, deleteRow, deleteTable } from \"prosemirror-tables\";\nimport React from \"react\"; // tslint:disable-next-line: no-var-requires\n\nvar Fragment = require('prosemirror-model').Fragment;\n\nfunction inTable(state) {\n  var path = state.selection.$head.path;\n\n  for (var i = 0; i < path.length; i += 3) {\n    if (path[i].type.name === 'table') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction generateEmptyCell(state, type) {\n  return type.create(undefined, Fragment.fromArray([state.schema.nodes.paragraph.create()]));\n}\n\nfunction insertTable(state, dispatch) {\n  var tr = state.tr.replaceSelectionWith(state.schema.nodes.table.create(undefined, Fragment.fromArray([state.schema.nodes.table_row.create(undefined, Fragment.fromArray([generateEmptyCell(state, state.schema.nodes.table_header), generateEmptyCell(state, state.schema.nodes.table_header)])), state.schema.nodes.table_row.create(undefined, Fragment.fromArray([generateEmptyCell(state, state.schema.nodes.table_cell), generateEmptyCell(state, state.schema.nodes.table_cell)]))])));\n\n  if (dispatch) {\n    dispatch(tr);\n  }\n\n  return true;\n}\n\nexport function CreateTableTool(schema) {\n  return {\n    name: \"table_create\",\n    label: \"Create Table\",\n    displayIcon: React.createElement(TableChart, null),\n    apply: insertTable,\n    isEnabled: function isEnabled(state) {\n      return canInsert(state, schema.nodes.table);\n    },\n    isVisible: function isVisible(state) {\n      return !inTable(state);\n    }\n  };\n}\nexport function AddRowTool(schema) {\n  return {\n    name: \"table_row_add\",\n    label: \"Add Row\",\n    displayIcon: React.createElement(VerticalAlignBottom, null),\n    apply: addRowAfter,\n    isVisible: function isVisible(state) {\n      return inTable(state);\n    }\n  };\n}\nexport function AddColumnTool(schema) {\n  return {\n    name: \"table_col_add\",\n    label: \"Add Column\",\n    displayIcon: React.createElement(LastPage, null),\n    apply: addColumnAfter,\n    isVisible: function isVisible(state) {\n      return inTable(state);\n    }\n  };\n}\nexport function DeleteRowTool(schema) {\n  return {\n    name: \"table_row_delete\",\n    label: \"Delete Row\",\n    displayIcon: React.createElement(VerticalAlignTop, null),\n    apply: deleteRow,\n    isVisible: function isVisible(state) {\n      return inTable(state);\n    }\n  };\n}\nexport function DeleteColumnTool(schema) {\n  return {\n    name: \"table_col_delete\",\n    label: \"Delete Column\",\n    displayIcon: React.createElement(FirstPage, null),\n    apply: deleteColumn,\n    isVisible: function isVisible(state) {\n      return inTable(state);\n    }\n  };\n}\nexport function DeleteTableTool(schema) {\n  return {\n    name: \"table_delete\",\n    label: \"Delete Table\",\n    displayIcon: React.createElement(BorderClear, null),\n    apply: deleteTable,\n    isVisible: function isVisible(state) {\n      return inTable(state);\n    }\n  };\n}","var __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nimport { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { AlignCenterTool, AlignJustifyTool, AlignLeftTool, AlignRightTool } from \"./alignment/AlignmentTools\";\nimport { AnchorTool } from \"./anchor\";\nimport { createInlineStylesTools } from \"./inline_styles\";\nimport { createMarkdownParser } from \"./markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"./markdown/MarkdownSerializer\";\nimport { createSchema } from \"./schema/createSchema\";\nimport { SoftHyphenTool } from \"./soft_hyphen\";\nimport { AddColumnTool, AddRowTool, CreateTableTool, DeleteColumnTool, DeleteRowTool, DeleteTableTool } from \"./tables/TableTools\";\nexport function createMarkdownTools(schema, options) {\n  var tools = [];\n\n  if (isToolEnabled(\"inline_styles\", options)) {\n    tools = tools.concat(tools, createInlineStylesTools(schema, options));\n  }\n\n  if (isToolEnabled(\"anchor\", options) && schema.nodes.anchor) {\n    tools.push(AnchorTool(schema, options.dialogs ? options.dialogs.getAnchor : undefined));\n  }\n\n  if (isToolEnabled(\"soft_hyphen\", options) && schema.nodes.soft_hyphen) {\n    tools.push(SoftHyphenTool(schema));\n  } // Alignment\n\n\n  if (isToolEnabled(\"align_left\", options)) {\n    tools.push(AlignLeftTool(schema));\n  }\n\n  if (isToolEnabled(\"align_center\", options)) {\n    tools.push(AlignCenterTool(schema));\n  }\n\n  if (isToolEnabled(\"align_right\", options)) {\n    tools.push(AlignRightTool(schema));\n  }\n\n  if (isToolEnabled(\"align_justify\", options)) {\n    tools.push(AlignJustifyTool(schema));\n  }\n\n  if (schema.nodes.table) {\n    if (isToolEnabled(\"table_create\", options)) {\n      tools.push(CreateTableTool(schema));\n    }\n\n    if (isToolEnabled(\"table_delete\", options)) {\n      tools.push(DeleteTableTool(schema));\n    }\n\n    if (isToolEnabled(\"table_row_add\", options)) {\n      tools.push(AddRowTool(schema));\n    }\n\n    if (isToolEnabled(\"table_col_add\", options)) {\n      tools.push(AddColumnTool(schema));\n    }\n\n    if (isToolEnabled(\"table_row_delete\", options)) {\n      tools.push(DeleteRowTool(schema));\n    }\n\n    if (isToolEnabled(\"table_col_delete\", options)) {\n      tools.push(DeleteColumnTool(schema));\n    }\n  }\n\n  return tools;\n}\n\nvar MarkdownLanguage =\n/** @class */\nfunction () {\n  function MarkdownLanguage(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.name = \"markdown\";\n    this.label = \"Markdown\";\n    var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\n    var schema = createSchema(isInlineStylesEnabled);\n\n    var tools = __spreadArrays(createStandardTools(schema, options), createMarkdownTools(schema, options));\n\n    var serializer = createMarkdownSerializer();\n    var parser = createMarkdownParser(schema);\n    this.schema = schema;\n    this.tools = tools;\n    this.serializer = serializer;\n    this.parser = parser;\n  }\n\n  MarkdownLanguage.prototype.serialize = function (doc) {\n    return this.serializer.serialize(doc);\n  };\n\n  MarkdownLanguage.prototype.parse = function (data) {\n    if (!data) {\n      data = \"\";\n    }\n\n    return this.parser.parse(data);\n  };\n\n  return MarkdownLanguage;\n}();\n\nexport default MarkdownLanguage;","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport Remove from \"@material-ui/icons/Remove\";\nimport React from \"react\";\nexport function SoftHyphenTool(schema) {\n  return {\n    name: \"soft_hyphen\",\n    label: \"Insert Soft Hyphen\",\n    displayIcon: React.createElement(Remove, null),\n    apply: function apply(state, dispatch) {\n      dispatch(state.tr.replaceSelectionWith(schema.nodes.soft_hyphen.create()));\n    },\n    isEnabled: function isEnabled(state) {\n      return canInsert(state, schema.nodes.soft_hyphen);\n    }\n  };\n}","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n  format: RichLanguageFormat.TEXT\n};\nexport default conf;","import MarkdownLanguage from \"./MarkdownLanguage\";\nimport MarkdownLanguageConfiguration from \"./MarkdownLanguageConfiguration\";\nexport default function (options) {\n  return {\n    language: new MarkdownLanguage(options),\n    conf: MarkdownLanguageConfiguration\n  };\n}\nexport * from \"./schema/createSchema\";\nexport { createMarkdownTools } from \"./MarkdownLanguage\";","import React from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarContextInterface {\n  getToolState?(toolName: string): ProseMirrorToolState | undefined;\n  applyTool?(toolName: string): void;\n}\n\nconst ProseMirrorToolbarContext = React.createContext<\n  ProseMirrorToolbarContextInterface\n>({});\nexport default ProseMirrorToolbarContext;\n","import { IconButton, withStyles, WithStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nimport clsx from \"clsx\";\n\nexport interface ProseMirrorToolbarButtonProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  toolName: string;\n}\n\nconst styles = {\n  root: {\n    margin: \"1px\"\n  }\n};\n\nconst ProseMirrorToolbarIconButton: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolName, classes } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolState = getToolState ? getToolState(toolName) : null;\n  const handleClick = React.useCallback(event => {\n    const focus = document.activeElement;\n    if (applyTool) {\n      applyTool(toolName);\n    }\n\n    // Focus will switch to the button, which is required to play the ripple effect.\n    // If we return it to the original element as soon as possible, the cursor will be in the same spot.\n    if (focus != null) {\n      setTimeout(() => (focus as HTMLElement).focus(), 0);\n    }\n  }, [toolName, applyTool]);\n\n  if (!toolState || !toolState.visible) {\n    return null;\n  }\n\n  return (\n    <IconButton\n      className={clsx(classes.root)}\n      onMouseDown={handleClick}\n      size=\"small\"\n      disabled={!toolState.enabled}\n      color={toolState.active ? \"primary\" : \"default\"}\n      title={toolState.label}\n    >\n      {toolState.displayIcon ? toolState.displayIcon : toolState.label}\n    </IconButton>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarIconButton);\n","import React, { ChangeEvent } from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\nimport { MenuItem, Select, WithStyles, withStyles } from \"@material-ui/core\";\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nconst styles = {\n  value: {\n    fontSize: 14,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"unset\" as \"unset\"\n  }\n};\n\nexport interface ProseMirrorToolbarButtonProps\n  extends WithStyles<typeof styles> {\n  toolNames: string[];\n  label?: string;\n}\n\nconst ProseMirrorToolbarDropdown: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolNames, classes, label } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolStates = toolNames\n    .map(toolName => {\n      const toolState = getToolState ? getToolState(toolName) : null;\n      return toolState;\n    })\n    .filter(x => x != null) as ProseMirrorToolState[];\n\n  let selectedItems: ProseMirrorToolState[] = toolStates.filter(x => x.active);\n  let selected;\n\n  if (selectedItems && selectedItems.length > 1 ){\n    selected = selectedItems.find(x => /inline_styles/.test(x.name )) || selectedItems[0];\n  } else {\n    selected = selectedItems.find(x => x.active);\n  }\n\n  const value = selected ? selected.name : \"\";\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<{ value: unknown }>) => {\n      if (applyTool) {\n        applyTool(event.target.value as string);\n      }\n    },\n    [applyTool]\n  );\n\n  // override renderValue so menu items can be styled\n  const renderValue = React.useCallback(\n    (toolName?: any) => {\n      if (!toolName) {\n        return label || \"\";\n      }\n\n      let toolState:\n        | { label: string; displayLabel?: React.ReactElement }\n        | undefined = getToolState ? getToolState(toolName) : undefined;\n\n      if (!toolState) {\n        toolState = { label: toolName };\n      }\n\n      if (toolState.displayLabel) {\n        return React.cloneElement(toolState.displayLabel, {\n          className: classes.value\n        });\n      }\n      return toolState.label;\n    },\n    [getToolState]\n  );\n\n  if (toolStates.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      renderValue={renderValue}\n      displayEmpty={true}\n      onMouseDown={(e) => e.preventDefault()}\n    >\n      {toolStates.map(toolState => {\n        return (\n          <MenuItem value={toolState.name} key={toolState.name} onMouseDown={(e) => e.preventDefault()}>\n            {toolState.displayLabel ? (\n              toolState.displayLabel\n            ) : (\n              <span>{toolState.label}</span>\n            )}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarDropdown);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport clsx from \"clsx\";\n\nconst styles = {\n  root: {\n    display: \"flex\",\n    alignItems: \"center\"\n  },\n  divider: {\n    verticalAlign: \"top\",\n    display: \"inline-flex\",\n    height: 13,\n    lineHeight: 13,\n    borderRight: \"1px solid rgb(218, 220, 224)\",\n    margin: \"9px 4px\"\n  },\n  empty: {\n    display: \"none\"\n  }\n};\n\nexport interface ProseMirrorToolbarGroupProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {}\n\nconst ProseMirrorToolbarGroup: React.SFC<ProseMirrorToolbarGroupProps> = (\n  props: ProseMirrorToolbarGroupProps\n) => {\n  const { children, classes } = props;\n\n  return (\n    <div\n      className={clsx(classes.root, {\n        [classes.empty]: !children\n      })}\n    >\n      {children}\n      <div className={classes.divider} />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarGroup);\n","import React from \"react\";\n\nimport {\n  Toolbar as MaterialToolbar,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\n\nimport { ProseMirrorToolbarContext } from \".\";\nimport { ProseMirrorToolbarIconButton } from \"../ProseMirrorToolbarIconButton\";\n\nimport ProseMirrorToolbarDropdown from \"../ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown\";\nimport { ProseMirrorToolbarGroup } from \"../ProseMirrorToolbarGroup\";\nimport { ProseMirrorToolbarState } from \"./ProseMirrorToolbarState\";\n\nconst styles = {\n  root: {\n    minHeight: 35,\n    borderBottom: \"1px solid rgb(218, 220, 224)\"\n  }\n};\n\nexport interface ToolbarButton {\n  type: \"button\";\n  toolName: string;\n}\n\nexport interface ToolbarDropDown {\n  type: \"dropdown\";\n  label?: string;\n  toolNames: string[];\n}\n\nexport interface ToolbarGroup {\n  type: \"group\";\n  children: ToolbarElement[];\n}\n\nexport type ToolbarElement = ToolbarButton | ToolbarGroup | ToolbarDropDown;\n\nexport interface ProseMirrorToolbarProps extends WithStyles<typeof styles> {\n  toolbarState?: ProseMirrorToolbarState;\n  layout: ToolbarElement[];\n}\n\nconst ProseMirrorToolbar: React.SFC<ProseMirrorToolbarProps> = (\n  props: ProseMirrorToolbarProps\n) => {\n  const { classes, layout, toolbarState } = props;\n\n  const renderToolbarElement = (element: ToolbarElement) => {\n    switch (element.type) {\n      case \"button\":\n        return <ProseMirrorToolbarIconButton toolName={element.toolName}/>;\n      case \"dropdown\":\n        return (\n          <ProseMirrorToolbarDropdown\n            toolNames={element.toolNames}\n            label={element.label}\n          />\n        );\n      case \"group\":\n        const toolVisible = (tool: ToolbarButton): boolean => {\n          const state = toolbarState == null ? null : toolbarState.toolStates[tool.toolName];\n          return state == null ? true : state.visible;\n        };\n\n        const anyVisible = element.children.findIndex(child =>\n          child.type !== \"button\" || toolVisible(child)\n        ) !== -1;\n        return anyVisible ? (\n          <ProseMirrorToolbarGroup>\n            {element.children.map(child => renderToolbarElement(child))}\n          </ProseMirrorToolbarGroup>\n        ) : null;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <ProseMirrorToolbarContext.Provider\n      value={{\n        applyTool: (toolName: string) => {\n          if (!toolbarState) {\n            return;\n          }\n\n          const tool = toolbarState.tools.find(x => x.name === toolName);\n          const areInlineStyles = Object.keys(toolbarState.toolStates).filter((x: any) => (/inline_styles/.test(x) && toolbarState.toolStates[x].active));\n          if (!tool) {\n            return;\n          }\n\n          if (areInlineStyles && areInlineStyles.length) {\n            const clearFormatting = toolbarState.tools.find(x => x.name === \"clear_formatting\");\n\n            clearFormatting && clearFormatting.apply(\n              toolbarState.editorView.state,\n              toolbarState.editorView.dispatch,\n              toolbarState.editorView\n            );\n          }\n\n          tool.apply(\n            toolbarState.editorView.state,\n            toolbarState.editorView.dispatch,\n            toolbarState.editorView\n          );\n        },\n        getToolState: (toolName: string) => {\n          if (!toolbarState) {\n            return undefined;\n          }\n\n          return toolbarState.toolStates[toolName];\n        }\n      }}\n    >\n      <MaterialToolbar className={classes.root} disableGutters={true}>\n        {layout.map(value => {\n          return renderToolbarElement(value);\n        })}\n      </MaterialToolbar>\n    </ProseMirrorToolbarContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbar);\n","import { ToolbarElement } from \"../ProseMirrorToolbar\";\n\nexport default [\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"undo\" },\n      { type: \"button\", toolName: \"redo\" }\n    ]\n  },\n\n  {\n    type: \"dropdown\",\n    label: \"Styles\",\n    toolNames: [\n      \"paragraph\",\n      \"heading_1\",\n      \"heading_2\",\n      \"heading_3\",\n      \"heading_4\",\n      \"heading_5\",\n      \"heading_6\",\n      \"code_block\"\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"strong\" },\n      { type: \"button\", toolName: \"em\" },\n      { type: \"button\", toolName: \"soft_hyphen\" },\n      { type: \"button\", toolName: \"link\" },\n      { type: \"button\", toolName: \"anchor\" },\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"align_left\" },\n      { type: \"button\", toolName: \"align_center\" },\n      { type: \"button\", toolName: \"align_right\" },\n      { type: \"button\", toolName: \"align_justify\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"lift\" },\n      { type: \"button\", toolName: \"bullet_list\" },\n      { type: \"button\", toolName: \"ordered_list\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"dc-image-link\" },\n      { type: \"button\", toolName: \"image\" },\n      { type: \"button\", toolName: \"dc-content-link\" },\n      { type: \"button\", toolName: \"blockquote\" },\n      { type: \"button\", toolName: \"code_block\" },\n      { type: \"button\", toolName: \"horizontal_rule\" },\n      { type: \"button\", toolName: \"table_create\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"table_row_add\" },\n      { type: \"button\", toolName: \"table_row_delete\" },\n      { type: \"button\", toolName: \"table_col_add\" },\n      { type: \"button\", toolName: \"table_col_delete\" },\n      { type: \"button\", toolName: \"table_delete\" },\n      { type: \"button\", toolName: \"clear_formatting\" }\n    ]\n  }\n] as ToolbarElement[];\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Anchor } from \"@dc-extension-rich-text/common\";\n\ninterface AnchorDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Anchor) => void;\n  value: any;\n}\n\nconst htmlIdRegex = /^[a-zA-Z][\\w:.\\-]*$/;\n\nfunction validateId(value: string): boolean {\n  return value != null && value.length > 0 && htmlIdRegex.test(value);\n}\n\nconst AnchorDialog: React.SFC<AnchorDialogProps> = (\n  props: AnchorDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Anchor>({\n    value: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Anchor>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateId(newValue.value));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      value: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Anchor</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={!isValid}\n            autoFocus={true}\n            id=\"value\"\n            label=\"Anchor ID\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.value}\n            onChange={event => handleInputChanged(\"value\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: paragraph-4\n          </FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default AnchorDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Hyperlink } from \"@dc-extension-rich-text/common\";\n\ninterface HyperlinkDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Hyperlink) => void;\n  value: any;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst HyperlinkDialog: React.SFC<HyperlinkDialogProps> = (\n  props: HyperlinkDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Hyperlink>({\n    href: \"\",\n    title: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Hyperlink>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.href));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      href: \"\",\n      title: \"\"\n    });\n    setLastValue(undefined);\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Hyperlink</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"href\"\n            label=\"Web Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.href}\n            onChange={event => handleInputChanged(\"href\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://www.storefront.com/black-friday\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Clear\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default HyperlinkDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Image } from \"@dc-extension-rich-text/common\";\n\ninterface ImageDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Image) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst ImageDialog: React.SFC<ImageDialogProps> = (props: ImageDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Image>({\n    src: \"\",\n    alt: \"\",\n    title: \"\"\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.src));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      src: \"\",\n      alt: \"\",\n      title: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Insert Image from URL</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"src\"\n            label=\"Image Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.src}\n            onChange={event => handleInputChanged(\"src\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://cdn.storefront.com/image.jpg\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Image Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"alt\"\n            label=\"Image Alternative Text\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.alt}\n            onChange={event => handleInputChanged(\"alt\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Insert\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ImageDialog;\n","import { RichTextDialogs } from \"@dc-extension-rich-text/common\";\nimport React from \"react\";\n\nexport interface RichTextDialogsContext {\n  dialogs?: RichTextDialogs;\n}\n\nconst context = React.createContext<RichTextDialogsContext>({});\nexport default context;\n","import React, { PropsWithChildren } from \"react\";\n\nimport {\n  Anchor,\n  Hyperlink,\n  Image,\n  RichTextDialogs\n} from \"@dc-extension-rich-text/common\";\nimport { ContentItemLink, MediaImageLink } from \"dc-extensions-sdk\";\nimport AnchorDialog from \"../AnchorDialog/AnchorDialog\";\nimport HyperlinkDialog from \"../HyperlinkDialog/HyperlinkDialog\";\nimport ImageDialog from \"../ImageDialog/ImageDialog\";\nimport RichTextDialogsContext from \"./RichTextDialogsContext\";\n\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\n\ninterface EditorDialogsProps extends PropsWithChildren<{}> {}\n\ninterface OpenDialog {\n  type: string;\n  resolve: (value: any) => void;\n  reject: () => void;\n  value: any;\n}\n\nconst RichTextDialogsContainer: React.SFC<EditorDialogsProps> = (\n  props: EditorDialogsProps\n) => {\n  const { children } = props;\n\n  const [openDialog, setOpenDialog] = React.useState<OpenDialog>();\n\n  const handleCloseDialog = React.useCallback(() => {\n    if (openDialog) {\n      openDialog.reject();\n    }\n    setOpenDialog(undefined);\n  }, [openDialog, setOpenDialog]);\n\n  const handleSubmitDialog = React.useCallback(\n    (value: any) => {\n      if (openDialog) {\n        openDialog.resolve(value);\n      }\n      setOpenDialog(undefined);\n    },\n    [openDialog, setOpenDialog]\n  );\n\n  const handleOpenDialog = React.useCallback(\n    (type: string, value?: any) => {\n      return new Promise((resolve, reject) => {\n        setOpenDialog({\n          type,\n          resolve,\n          reject,\n          value\n        });\n      });\n    },\n    [setOpenDialog]\n  );\n\n  const { sdk } = React.useContext(SdkContext);\n\n  const dialogs: RichTextDialogs = {\n    getAnchor: (value?: Anchor): Promise<Anchor> => {\n      return handleOpenDialog(\"anchor\", value) as Promise<Anchor>;\n    },\n    getHyperlink: (value?: Hyperlink): Promise<Hyperlink> => {\n      return handleOpenDialog(\"hyperlink\", value) as Promise<Hyperlink>;\n    },\n    getImage: (value?: Image): Promise<Image> => {\n      return handleOpenDialog(\"image\") as Promise<Image>;\n    },\n    getDcImageLink: (value?: MediaImageLink): Promise<MediaImageLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.mediaLink.getImage();\n      }\n    },\n    getDcContentLink: (\n      contentTypeIds: string[],\n      value?: ContentItemLink\n    ): Promise<ContentItemLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.contentLink.get(contentTypeIds);\n      }\n    }\n  };\n\n  return (\n    <RichTextDialogsContext.Provider value={{ dialogs }}>\n      {children}\n\n      <AnchorDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"anchor\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <HyperlinkDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"hyperlink\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <ImageDialog\n        open={openDialog != null && openDialog.type === \"image\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n    </RichTextDialogsContext.Provider>\n  );\n};\n\nexport default RichTextDialogsContainer;\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\nimport CodeTextArea from \"../CodeTextArea/CodeTextArea\";\nimport ProseMirror from \"../ProseMirror/ProseMirror\";\nimport { EditorView, ViewSwitcher } from \"../ViewSwitcher\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration,\n  RichLanguageFormat\n} from \"@dc-extension-rich-text/common\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport ProseMirrorToolbar, {\n  ToolbarElement\n} from \"../ProseMirrorToolbar/ProseMirrorToolbar\";\nimport DefaultToolbar from \"./DefaultToolbar\";\n\nimport { computeToolbarState } from \"../ProseMirrorToolbar/ProseMirrorToolbarState\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\"\n  },\n  frame: {\n    flex: 1,\n    display: \"flex\",\n    flexDirection: \"column\" as \"column\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    borderRadius: 5,\n    padding: \"0 10px 10px 10px\"\n  }\n};\n\ninterface RichTextLanguageMap {\n  [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n}\n\nexport interface RichTextEditorProps extends WithStyles<typeof styles> {\n  languages?: RichTextLanguageMap;\n  language?: string;\n\n  disableToolbar?: boolean;\n  toolbarLayout?: ToolbarElement[];\n\n  disableCodeView?: boolean;\n  readOnlyCodeView?: boolean;\n\n  editorViewOptions?: any;\n\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nconst RichTextEditor: React.SFC<RichTextEditorProps> = (\n  props: RichTextEditorProps\n) => {\n  const {\n    classes,\n    languages: languagesProp,\n    language: languageProp = \"markdown\",\n    toolbarLayout: toolbarLayoutProp,\n    disableToolbar = false,\n\n    disableCodeView = false,\n    readOnlyCodeView = false,\n\n    editorViewOptions,\n\n    value: valueProp,\n    onChange\n  } = props;\n\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const languages: RichTextLanguageMap = languagesProp || {\n    markdown: MarkdownLanguage({\n      dialogs\n    })\n  };\n\n  if (!languages[languageProp]) {\n    throw new Error(`Unable to find language ${props.language}`);\n  }\n\n  const { language, conf: languageConfiguration } = languages[languageProp];\n\n  const [view, setView] = React.useState(EditorView.EDIT);\n  const [rawValue, setRawValue] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    if (languageConfiguration.format === RichLanguageFormat.JSON) {\n      return JSON.stringify(valueProp, null, 3);\n    } else {\n      return valueProp;\n    }\n  });\n  const [proseMirrorDocument, setProseMirrorDocument] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    try {\n      return language.parse(valueProp);\n      // tslint:disable-next-line\n    } catch (err) {\n    }\n  });\n\n  const handleRawValueChange = React.useCallback(\n    (value: any) => {\n      setRawValue(value);\n\n      if (languageConfiguration.format === RichLanguageFormat.JSON) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {\n          return;\n        }\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n\n      try {\n        const newProseMirrorDocument = language.parse(value);\n        setProseMirrorDocument(newProseMirrorDocument);\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setRawValue, setProseMirrorDocument, onChange]\n  );\n\n  const handleEditorChange = React.useCallback(\n    (doc: any) => {\n      setProseMirrorDocument(doc);\n      try {\n        const newRawValue = language.serialize(doc);\n\n        if (languageConfiguration.format === RichLanguageFormat.JSON) {\n          setRawValue(JSON.stringify(newRawValue, null, 3));\n        } else {\n          setRawValue(newRawValue);\n        }\n\n        if (onChange) {\n          onChange(newRawValue);\n        }\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setProseMirrorDocument, setRawValue]\n  );\n\n  const [toolbarState, setToolbarState] = React.useState();\n  const toolbarLayout = toolbarLayoutProp || DefaultToolbar;\n\n  const handleEditorUpdateState = React.useCallback(\n    (state: any, editorView: any) => {\n      setToolbarState(computeToolbarState(language.tools, state, editorView));\n    },\n    [language, setToolbarState]\n  );\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.frame}>\n        <ViewSwitcher\n          onChange={setView}\n          language={language.label}\n          disableCodeView={disableCodeView}\n        />\n        {view === EditorView.EDIT ? (\n          <div>\n            {disableToolbar ? (\n              false\n            ) : (\n              <ProseMirrorToolbar\n                toolbarState={toolbarState}\n                layout={toolbarLayout}\n              />\n            )}\n            <ProseMirror\n              editorViewOptions={editorViewOptions}\n              schema={language.schema}\n              onChange={handleEditorChange}\n              onUpdateState={handleEditorUpdateState}\n              doc={proseMirrorDocument}\n            />\n          </div>\n        ) : (\n          <CodeTextArea\n            value={rawValue}\n            onChange={handleRawValueChange}\n            readOnly={readOnlyCodeView}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditor);\n","import {\n  ProseMirrorTool,\n  ProseMirrorToolState\n} from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarState {\n  tools: ProseMirrorTool[];\n  toolStates: { [toolName: string]: ProseMirrorToolState };\n  editorView: any;\n}\n\nexport function computeToolbarState(\n  tools: ProseMirrorTool[],\n  editorState: any,\n  editorView: any\n): ProseMirrorToolbarState {\n  const toolStates: { [toolName: string]: ProseMirrorToolState } = {};\n\n  for (const tool of tools) {\n    const state = {\n      active: false,\n      enabled: true,\n      visible: true,\n      ...tool\n    };\n\n    if (tool.isActive) {\n      state.active = tool.isActive(editorState, editorView);\n    }\n\n    if (tool.isVisible) {\n      state.visible = tool.isVisible(editorState, editorView);\n    }\n\n    if (tool.isEnabled) {\n      state.enabled = tool.isEnabled(editorState, editorView);\n    }\n\n    toolStates[tool.name] = state;\n  }\n\n  return {\n    tools,\n    toolStates,\n    editorView\n  };\n}\n","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React from \"react\";\nimport { withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nvar styles = {\n  root: {\n    display: \"block\",\n    width: \"100%\",\n    minHeight: 150,\n    margin: \"0 10px 10px 0\",\n    position: \"relative\"\n  },\n  content: {},\n  \"empty-slot\": {},\n  \"populated-slot\": {}\n};\n\nvar InlineChooser = function InlineChooser(props) {\n  var _a;\n\n  var classes = props.classes,\n      children = props.children,\n      className = props.className,\n      _b = props.variant,\n      variant = _b === void 0 ? \"empty\" : _b,\n      aspectRatio = props.aspectRatio,\n      other = __rest(props, [\"classes\", \"children\", \"className\", \"variant\", \"aspectRatio\"]);\n\n  var aspectRatioPaddingTop = React.useMemo(function () {\n    if (!aspectRatio) {\n      return undefined;\n    }\n\n    var components = aspectRatio.split(':');\n\n    if (components.length !== 2) {\n      return undefined;\n    }\n\n    return Math.round(Number(components[1]) / Number(components[0]) * 100) + '%';\n  }, [aspectRatio]);\n  return React.createElement(\"div\", __assign({}, other, {\n    className: clsx(classes.root, (_a = {}, _a[classes[\"empty-slot\"]] = variant === \"empty-slot\", _a[classes[\"populated-slot\"]] = variant === \"populated-slot\", _a), className)\n  }), aspectRatio ? React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    style: {\n      display: 'block',\n      paddingTop: aspectRatioPaddingTop\n    }\n  }, \"\\xA0\"), React.createElement(\"div\", {\n    className: clsx(classes.content)\n  }, children)) : React.createElement(\"div\", {\n    className: clsx(classes.content)\n  }, children));\n};\n\nexport default withStyles(styles)(InlineChooser);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, DeleteIcon, StyledFab, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { CircularProgress, withStyles } from '@material-ui/core'; // tslint:disable-next-line\n\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage';\nimport clsx from 'clsx';\nvar styles = {\n  root: {\n    '&$broken, &$invalid': {\n      background: '#e5e5e5'\n    }\n  },\n  image: {\n    maxWidth: '100%'\n  },\n  loading: {},\n  broken: {},\n  invalid: {},\n  statusIcons: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    position: 'absolute',\n    alignItems: 'center',\n    alignContent: 'center',\n    flexDirection: 'row',\n    justifyContent: 'center'\n  }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n  var _a;\n\n  var node = props.node,\n      onDelete = props.onDelete,\n      classes = props.classes,\n      options = props.options;\n  var value = node.attrs.value; // BrokenImageIcon\n\n  var _b = React.useState(false),\n      broken = _b[0],\n      setBroken = _b[1];\n\n  var _c = React.useState(false),\n      loading = _c[0],\n      setLoading = _c[1];\n\n  var handleLoading = React.useCallback(function () {\n    setLoading(true);\n  }, [setLoading]);\n  var handleError = React.useCallback(function () {\n    setBroken(true);\n    setLoading(false);\n  }, [setBroken, setLoading]);\n  var handleLoaded = React.useCallback(function () {\n    setBroken(false);\n    setLoading(false);\n  }, [setBroken, setLoading]);\n  var hasValidValue = value && value.endpoint && value.name; //Workaround for ts-jest\n\n  var Fab = StyledFab;\n  return React.createElement(\"div\", {\n    className: clsx(classes.root, (_a = {}, _a[classes.broken] = broken, _a[classes.loading] = loading, _a[classes.invalid] = !hasValidValue, _a))\n  }, React.createElement(InlineChooser, {\n    variant: \"populated-slot\",\n    aspectRatio: broken || loading || !hasValidValue ? '3:1' : undefined\n  }, hasValidValue ? React.createElement(\"img\", {\n    className: classes.image,\n    src: \"//\" + (options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? options.dynamicContent.stagingEnvironment : value.defaultHost) + \"/i/\" + value.endpoint + \"/\" + encodeURIComponent(value.name),\n    onLoadStart: handleLoading,\n    onError: handleError,\n    onLoad: handleLoaded,\n    alt: \"\"\n  }) : false, React.createElement(\"div\", {\n    className: classes.statusIcons\n  }, loading ? React.createElement(CircularProgress, null) : broken || !hasValidValue ? React.createElement(BrokenImageIcon, {\n    fontSize: \"large\"\n  }) : false), React.createElement(ChooserActions, {\n    variant: \"populated-slot\"\n  }, React.createElement(Fab, {\n    variant: \"dark\",\n    onClick: onDelete\n  }, DeleteIcon))));\n});\n\nvar DcImageLinkView =\n/** @class */\nfunction () {\n  function DcImageLinkView(node, view, getPos, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.options = options;\n    this.dom = document.createElement('div');\n    this.handleDelete = this.handleDelete.bind(this);\n    this.render();\n  }\n\n  DcImageLinkView.prototype.handleDelete = function () {\n    var start = this.getPos();\n    var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n    this.view.dispatch(tr);\n  };\n\n  DcImageLinkView.prototype.render = function () {\n    ReactDOM.render(withTheme(React.createElement(ViewComponent, {\n      options: this.options,\n      node: this.node,\n      onDelete: this.handleDelete\n    })), this.dom);\n  };\n\n  return DcImageLinkView;\n}();\n\nexport { DcImageLinkView };","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, ContentItem as ContentItemIcon, DeleteIcon, getContentTypeCard, getContentTypeIcon, StyledFab, Visualization, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { withStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nvar styles = {\n  root: {\n    '&$broken, &$invalid': {\n      background: '#e5e5e5'\n    },\n    boxShadow: \"0 1px 5px 0 rgba(23,32,44,.2), 0 2px 2px 0 rgba(23,32,44,.1), 0 3px 1px -2px rgba(23,32,44,.1)\"\n  },\n  invalid: {},\n  content: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundSize: \"contain\",\n    backgroundRepeat: \"no-repeat\",\n    backgroundPosition: \"50%\"\n  },\n  statusIcons: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'flex',\n    position: 'absolute',\n    alignItems: 'center',\n    alignContent: 'center',\n    flexDirection: 'row',\n    justifyContent: 'center'\n  }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n  var _a;\n\n  var node = props.node,\n      onDelete = props.onDelete,\n      classes = props.classes,\n      options = props.options;\n  var value = node.attrs.value;\n  var hasValidValue = value && value.id && value.contentType;\n  var contentLinkOptions = options.tools && options.tools[\"dc-content-link\"] ? options.tools[\"dc-content-link\"] : undefined;\n  var customIcon = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeIcon(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\n  var cardTemplateUrl = contentLinkOptions && contentLinkOptions.contentTypeSettings && hasValidValue ? getContentTypeCard(contentLinkOptions.contentTypeSettings, value.contentType) : undefined;\n  var aspectRatio = contentLinkOptions && contentLinkOptions.contentTypeSettings && contentLinkOptions.contentTypeSettings.aspectRatios && hasValidValue ? getContentTypeAspectRatio(contentLinkOptions.contentTypeSettings.aspectRatios, value.contentType) : undefined; //Workaround for ts-jest\n\n  var Fab = StyledFab;\n  return React.createElement(\"div\", {\n    className: clsx(classes.root, (_a = {}, _a[classes.invalid] = !hasValidValue, _a))\n  }, React.createElement(InlineChooser, {\n    variant: \"populated-slot\",\n    aspectRatio: aspectRatio || '3:1'\n  }, React.createElement(\"div\", {\n    className: clsx(classes.content),\n    style: {\n      backgroundImage: \"url(\" + (customIcon || ContentItemIcon) + \")\"\n    }\n  }, cardTemplateUrl && options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? React.createElement(Visualization, {\n    template: cardTemplateUrl,\n    params: {\n      contentItemId: value.id,\n      stagingEnvironment: options.dynamicContent.stagingEnvironment\n    }\n  }) : false), React.createElement(ChooserActions, {\n    variant: \"populated-slot\"\n  }, React.createElement(Fab, {\n    variant: \"dark\",\n    onClick: onDelete\n  }, DeleteIcon))));\n});\nexport function getContentTypeAspectRatio(aspectRatios, schemaId) {\n  for (var _i = 0, _a = Object.keys(aspectRatios); _i < _a.length; _i++) {\n    var key = _a[_i];\n\n    if (key === \"*\" || key === schemaId) {\n      return aspectRatios[key];\n    }\n  }\n}\n\nvar DcContentLinkView =\n/** @class */\nfunction () {\n  function DcContentLinkView(node, view, getPos, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.node = node;\n    this.view = view;\n    this.getPos = getPos;\n    this.options = options;\n    this.dom = document.createElement('div');\n    this.handleDelete = this.handleDelete.bind(this);\n    this.render();\n  }\n\n  DcContentLinkView.prototype.handleDelete = function () {\n    var start = this.getPos();\n    var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n    this.view.dispatch(tr);\n  };\n\n  DcContentLinkView.prototype.render = function () {\n    ReactDOM.render(withTheme(React.createElement(ViewComponent, {\n      options: this.options,\n      node: this.node,\n      onDelete: this.handleDelete\n    })), this.dom);\n  };\n\n  return DcContentLinkView;\n}();\n\nexport { DcContentLinkView };","var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport React from 'react';\nimport { isToolEnabled, inBlock } from '@dc-extension-rich-text/common'; // tslint:disable-next-line\n\nimport AddCircleIcon from '@material-ui/icons/AddCircle'; // tslint:disable-next-line\n\nimport ImageSearchIcon from '@material-ui/icons/ImageSearch';\nexport function dcImageLink(schema, dialog) {\n  var _this = this;\n\n  var node = schema.nodes['dc-image-link'];\n  return {\n    name: 'dc-image-link',\n    label: 'Insert Image',\n    displayIcon: React.createElement(ImageSearchIcon, null),\n    isEnabled: function isEnabled(state) {\n      return !inBlock(state);\n    },\n    apply: function apply(state, dispatch, view) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var value, err_1;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!dialog) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , dialog()];\n\n            case 2:\n              value = _a.sent();\n              view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\n                value: value\n              })));\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              err_1 = _a.sent();\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  };\n}\nexport function dcContentLink(schema, contentTypes, dialog) {\n  var _this = this;\n\n  var node = schema.nodes['dc-content-link'];\n  return {\n    name: 'dc-content-link',\n    label: 'Insert Content',\n    displayIcon: React.createElement(AddCircleIcon, null),\n    isEnabled: function isEnabled(state) {\n      return !inBlock(state);\n    },\n    apply: function apply(state, dispatch, view) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var value, err_2;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (!dialog) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              _a.label = 1;\n\n            case 1:\n              _a.trys.push([1, 3,, 4]);\n\n              return [4\n              /*yield*/\n              , dialog(contentTypes)];\n\n            case 2:\n              value = _a.sent();\n              view.dispatch(view.state.tr.replaceSelectionWith(node.createAndFill({\n                value: value\n              })));\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              err_2 = _a.sent();\n              return [3\n              /*break*/\n              , 4];\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  };\n}\nexport function createDynamicContentTools(schema, options) {\n  var tools = [];\n\n  if (isToolEnabled('dc-image-link', options) && schema.nodes['dc-image-link']) {\n    tools.push(dcImageLink(schema, options.dialogs ? options.dialogs.getDcImageLink : undefined));\n  }\n\n  if (isToolEnabled('dc-content-link', options) && schema.nodes['dc-content-link'] && // must provide a list of content types for this tool to be active\n  options.tools && options.tools[\"dc-content-link\"] && options.tools[\"dc-content-link\"].contentTypes && options.tools[\"dc-content-link\"].contentTypes) {\n    tools.push(dcContentLink(schema, options.tools[\"dc-content-link\"].contentTypes, options.dialogs ? options.dialogs.getDcContentLink : undefined));\n  }\n\n  return tools;\n}","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar DcContentLinkBlock =\n/** @class */\nfunction () {\n  function DcContentLinkBlock() {}\n\n  DcContentLinkBlock.prototype.canSerialize = function (schema, node) {\n    return node.type === \"dc-content-link\";\n  };\n\n  DcContentLinkBlock.prototype.serialize = function (schema, nodes) {\n    return nodes.map(function (node) {\n      return {\n        type: \"dc-content-link\",\n        data: node.attrs.value\n      };\n    });\n  };\n\n  DcContentLinkBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"dc-content-link\";\n  };\n\n  DcContentLinkBlock.prototype.parse = function (schema, blocks) {\n    var result = [];\n    blocks.forEach(function (block) {\n      result.push({\n        type: \"dc-content-link\",\n        attrs: {\n          value: block.data\n        }\n      });\n    });\n    return result;\n  };\n\n  return DcContentLinkBlock;\n}();\n\nexport default DcContentLinkBlock;","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar DcImageLinkBlock =\n/** @class */\nfunction () {\n  function DcImageLinkBlock() {}\n\n  DcImageLinkBlock.prototype.canSerialize = function (schema, node) {\n    return node.type === \"dc-image-link\";\n  };\n\n  DcImageLinkBlock.prototype.serialize = function (schema, nodes) {\n    return nodes.map(function (node) {\n      return {\n        type: \"dc-image-link\",\n        data: node.attrs.value\n      };\n    });\n  };\n\n  DcImageLinkBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"dc-image-link\";\n  };\n\n  DcImageLinkBlock.prototype.parse = function (schema, blocks) {\n    var result = [];\n    blocks.forEach(function (block) {\n      result.push({\n        type: \"dc-image-link\",\n        attrs: {\n          value: block.data\n        }\n      });\n    });\n    return result;\n  };\n\n  return DcImageLinkBlock;\n}();\n\nexport default DcImageLinkBlock;","import { getDefaultSerializerParser } from '@dc-extension-rich-text/language-markdown'; // tslint:disable-next-line\n\nvar markdown = require(\"prosemirror-markdown\"); // tslint:disable-next-line\n\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar MarkdownBlock =\n/** @class */\nfunction () {\n  function MarkdownBlock() {}\n\n  MarkdownBlock.prototype.canSerialize = function (schema, node) {\n    this.ensureInit(schema);\n\n    if (!node.type) {\n      return false;\n    } else {\n      return this.serializer.nodes[node.type] != null;\n    }\n  };\n\n  MarkdownBlock.prototype.serialize = function (schema, nodes) {\n    this.ensureInit(schema);\n    var parsedNodes = Node.fromJSON(schema, {\n      type: \"doc\",\n      content: nodes\n    });\n    return [{\n      type: \"markdown\",\n      data: this.serializer.serialize(parsedNodes)\n    }];\n  };\n\n  MarkdownBlock.prototype.canParse = function (schema, block) {\n    return block.type === \"markdown\";\n  };\n\n  MarkdownBlock.prototype.parse = function (schema, blocks) {\n    var _this = this;\n\n    this.ensureInit(schema);\n    var result = [];\n    blocks.forEach(function (block) {\n      var doc = _this.parser.parse(block.data || '').toJSON();\n\n      result = result.concat.apply(result, doc.content || []);\n    });\n    return result;\n  };\n\n  MarkdownBlock.prototype.ensureInit = function (schema) {\n    var _a;\n\n    _a = getDefaultSerializerParser(schema), this.serializer = _a[0], this.parser = _a[1];\n  };\n\n  return MarkdownBlock;\n}();\n\nexport default MarkdownBlock;","import { createSchema as createMarkdownSchema } from \"@dc-extension-rich-text/language-markdown\";\nimport { DcContentLinkNode, DcImageLinkNode } from \"@dc-extension-rich-text/prosemirror-dynamic-content\"; // tslint:disable-next-line\n\nvar Schema = require(\"prosemirror-model\").Schema;\n\nexport function createSchema(isInlineStylesEnabled) {\n  var schema = createMarkdownSchema(isInlineStylesEnabled);\n  return new Schema({\n    nodes: schema.spec.nodes.addBefore(\"image\", \"dc-image-link\", DcImageLinkNode()).addBefore(\"image\", \"dc-content-link\", DcContentLinkNode()),\n    marks: schema.spec.marks\n  });\n}","var __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nimport { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { createMarkdownTools } from \"@dc-extension-rich-text/language-markdown\";\nimport { createDynamicContentTools } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport DcContentLinkBlock from \"./blocks/DcContentLinkBlock\";\nimport DcImageLinkBlock from \"./blocks/DcImageLinkBlock\";\nimport MarkdownBlock from \"./blocks/MarkdownBlock\";\nimport { createSchema } from \"./schema/createSchema\"; // tslint:disable-next-line\n\nvar Node = require(\"prosemirror-model\").Node;\n\nvar JSONLanguage =\n/** @class */\nfunction () {\n  function JSONLanguage(options, blockTypes) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    if (blockTypes === void 0) {\n      blockTypes = [new MarkdownBlock(), new DcImageLinkBlock(), new DcContentLinkBlock()];\n    }\n\n    this.blockTypes = blockTypes;\n    this.name = \"json\";\n    this.label = \"JSON\";\n    var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\n    var schema = createSchema(isInlineStylesEnabled);\n\n    var tools = __spreadArrays(createStandardTools(schema, options), createDynamicContentTools(schema, options), createMarkdownTools(schema, options));\n\n    this.schema = schema;\n    this.tools = tools;\n  }\n\n  JSONLanguage.prototype.serialize = function (doc) {\n    var _this = this;\n\n    if (!doc) {\n      return [];\n    }\n\n    doc = doc.toJSON();\n    var fragments = [];\n\n    if (!doc.content || doc.content.length === 0) {\n      return fragments;\n    }\n\n    var nodesByConverter = groupBy(doc.content, function (node) {\n      for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n        var blockType = _a[_i];\n\n        if (blockType.canSerialize(_this.schema, node)) {\n          return blockType;\n        }\n      }\n    });\n    var blocks = [];\n\n    for (var _i = 0, nodesByConverter_1 = nodesByConverter; _i < nodesByConverter_1.length; _i++) {\n      var group = nodesByConverter_1[_i];\n      var groupBlocks = group.group.serialize(this.schema, group.items);\n      blocks = blocks.concat.apply(blocks, groupBlocks);\n    }\n\n    return blocks;\n  };\n\n  JSONLanguage.prototype.parse = function (blocks) {\n    var _this = this;\n\n    if (!blocks || blocks.length === 0) {\n      return Node.fromJSON(this.schema, {\n        type: \"doc\",\n        content: [{\n          type: \"paragraph\"\n        }]\n      });\n    }\n\n    var result = {\n      type: \"doc\",\n      content: []\n    };\n    var blocksGroupedByConverter = groupBy(blocks, function (block) {\n      for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n        var blockType = _a[_i];\n\n        if (blockType.canParse(_this.schema, block)) {\n          return blockType;\n        }\n      }\n    });\n\n    for (var _i = 0, blocksGroupedByConverter_1 = blocksGroupedByConverter; _i < blocksGroupedByConverter_1.length; _i++) {\n      var group = blocksGroupedByConverter_1[_i];\n      var parsedNodes = group.group.parse(this.schema, group.items);\n      result.content = result.content.concat.apply(result.content, parsedNodes);\n    }\n\n    return Node.fromJSON(this.schema, result);\n  };\n\n  return JSONLanguage;\n}();\n\nexport default JSONLanguage;\n\nfunction groupBy(items, groupFn) {\n  var result = [];\n  var currentGroup = null;\n  var currentGroupItems = [];\n\n  for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n    var item = items_1[_i];\n    var itemGroup = groupFn(item);\n\n    if (itemGroup === undefined) {\n      continue;\n    }\n\n    if (currentGroup === null) {\n      currentGroup = itemGroup;\n      currentGroupItems = [item];\n    } else if (currentGroup === itemGroup) {\n      currentGroupItems.push(item);\n    } else {\n      if (currentGroupItems.length > 0) {\n        result.push({\n          group: currentGroup,\n          items: currentGroupItems\n        });\n      }\n\n      currentGroup = itemGroup;\n      currentGroupItems = [item];\n    }\n  }\n\n  if (currentGroupItems.length > 0 && currentGroup !== null) {\n    result.push({\n      group: currentGroup,\n      items: currentGroupItems\n    });\n  }\n\n  return result;\n}","export function DcImageLinkNode() {\n  return {\n    content: \"block\",\n    group: \"block\",\n    defining: true,\n    attrs: {\n      value: {}\n    },\n    nodeSize: 1,\n    draggable: true,\n    atom: true,\n    parseDOM: [{\n      tag: \"dc-image-link[data-dc-image-link]\",\n      getAttrs: function getAttrs(dom) {\n        var value = JSON.parse(dom.getAttribute(\"data-dc-image-link\"));\n        return {\n          value: value\n        };\n      }\n    }],\n    toDOM: function toDOM(node) {\n      var value = node.attrs.value;\n      return [\"dc-image-link\", {\n        \"data-dc-image-link\": JSON.stringify(value)\n      }];\n    }\n  };\n}","export function DcContentLinkNode() {\n  return {\n    content: \"block\",\n    group: \"block\",\n    defining: true,\n    attrs: {\n      value: {}\n    },\n    nodeSize: 1,\n    draggable: true,\n    atom: true,\n    parseDOM: [{\n      tag: \"dc-content-link[data-dc-content-link]\",\n      getAttrs: function getAttrs(dom) {\n        var value = JSON.parse(dom.getAttribute(\"data-dc-content-link\"));\n        return {\n          value: value\n        };\n      }\n    }],\n    toDOM: function toDOM(node) {\n      var value = node.attrs.value;\n      return [\"dc-content-link\", {\n        \"data-dc-content-link\": JSON.stringify(value)\n      }];\n    }\n  };\n}","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n  format: RichLanguageFormat.JSON\n};\nexport default conf;","import React from \"react\";\n\nimport { withStyles, WithStyles } from \"@material-ui/core\";\n\nimport { ToolbarElement } from \"../ProseMirrorToolbar\";\nimport { RichTextEditor } from \"../RichTextEditor\";\n\nimport JSONLanguage from \"@dc-extension-rich-text/language-json\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport { ContentTypeSettings, SdkContext } from \"unofficial-dynamic-content-ui\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration\n} from \"@dc-extension-rich-text/common\";\nimport {\n  DcContentLinkView,\n  DcImageLinkView,\n  DynamicContentToolOptions\n} from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nexport const styles = {\n  root: {\n    width: \"100%\"\n  }\n};\n\nexport interface EditorRichTextFieldProps extends WithStyles<typeof styles> {\n  schema: any;\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nexport interface EditorRichTextFieldParams {\n  language?: string;\n\n  styles?: string;\n  stylesheet?: string;\n\n  codeView?: {\n    readOnly?: boolean;\n    disabled?: boolean;\n  };\n\n  editView?: {};\n\n  toolbar?: {\n    layout?: ToolbarElement[];\n    disabled?: boolean;\n  };\n\n  tools?: {\n    whitelist?: string[];\n    blacklist?: string[];\n\n    \"dc-content-link\"?: {\n      contentTypes?: string[];\n      contentTypeSettings?: ContentTypeSettings & {\n        aspectRatios?: { [schemaId: string]: string };\n      };\n    };\n  };\n}\n\nconst EditorRichTextField: React.SFC<EditorRichTextFieldProps> = (\n  props: EditorRichTextFieldProps\n) => {\n  const { schema, value: valueProp, onChange, classes } = props;\n\n  const params: EditorRichTextFieldParams =\n    schema && schema[\"ui:extension\"] && schema[\"ui:extension\"].params\n      ? schema[\"ui:extension\"].params\n      : {};\n\n  const { sdk } = React.useContext(SdkContext);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  const toolOptions = React.useMemo<DynamicContentToolOptions>(() => {\n    const settings = {\n      dialogs,\n      dynamicContent: {\n        stagingEnvironment: sdk ? sdk.stagingEnvironment : undefined\n      },\n      tools: params.tools\n    };\n\n    if (settings.tools && !settings.tools.blacklist) {\n      // disable inline_styles by default\n      settings.tools.blacklist = [\"inline_styles\"];\n    }\n\n    return settings;\n  }, [sdk, dialogs, params]);\n\n  const languages = React.useMemo<{\n    [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n  }>(() => {\n    return {\n      markdown: MarkdownLanguage(toolOptions),\n      json: JSONLanguage(toolOptions)\n    };\n  }, []);\n\n  const language = params.language || \"markdown\";\n\n  const editorViewOptions = React.useMemo(() => {\n    return {\n      nodeViews: {\n        \"dc-image-link\": (node: any, view: any, getPos: any) =>\n          new DcImageLinkView(node, view, getPos, toolOptions),\n        \"dc-content-link\": (node: any, view: any, getPos: any) =>\n          new DcContentLinkView(node, view, getPos, toolOptions)\n      }\n    };\n  }, [sdk, toolOptions]);\n\n  return (\n    <div className={classes.root}>\n      {params.styles ? (\n        <style dangerouslySetInnerHTML={{ __html: params.styles }} />\n      ) : (\n        false\n      )}\n      {params.stylesheet ? (\n        <link rel=\"stylesheet\" href={params.stylesheet} />\n      ) : (\n        false\n      )}\n\n      <RichTextEditor\n        languages={languages}\n        language={params.language}\n        editorViewOptions={editorViewOptions}\n        toolbarLayout={params.toolbar ? params.toolbar.layout : undefined}\n        disableToolbar={params.toolbar ? params.toolbar.disabled : undefined}\n        disableCodeView={params.codeView ? params.codeView.disabled : undefined}\n        readOnlyCodeView={\n          params.codeView ? params.codeView.readOnly : undefined\n        }\n        onChange={onChange}\n        value={valueProp}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(EditorRichTextField);\n","import JSONLanguage from \"./JSONLanguage\";\nimport JSONLanguageConfiguration from \"./JSONLanguageConfiguration\";\nexport default function (options) {\n  return {\n    language: new JSONLanguage(options),\n    conf: JSONLanguageConfiguration\n  };\n}\nexport * from \"./JSONLanguage\";\nexport * from \"./JSONLanguageConfiguration\";\nexport * from \"./schema/createSchema\";\nexport * from \"./blocks/DcImageLinkBlock\";\nexport * from \"./blocks/MarkdownBlock\";","import React from \"react\";\n\nimport { init, SDK } from \"dc-extensions-sdk\";\nimport { SdkContext, withTheme } from \"unofficial-dynamic-content-ui\";\nimport EditorRichTextField from \"./EditorRichTextField/EditorRichTextField\";\nimport { RichTextDialogsContainer } from \"./RichTextDialogs\";\n\ninterface AppState {\n  connected: boolean;\n  sdk?: SDK;\n  value?: string;\n}\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = { connected: false };\n    this.handleValueChange = this.handleValueChange.bind(this);\n    this.handleChooseLink = this.handleChooseLink.bind(this);\n  }\n\n  public componentDidMount(): void {\n    this.handleConnect();\n  }\n\n  public async handleConnect(): Promise<void> {\n    const sdk: SDK = await init();\n    sdk.frame.startAutoResizer();\n\n    const value: any = await sdk.field.getValue();\n    this.setState({\n      sdk,\n      connected: true,\n      value\n    });\n  }\n\n  public handleValueChange(value: any): void {\n    if (this.state.connected && this.state.sdk) {\n      this.state.sdk.field.setValue(value);\n    }\n  }\n\n  public async handleChooseLink(): Promise<{ href: string; title: string }> {\n    return { href: \"\", title: \"\" };\n  }\n\n  public render(): React.ReactElement {\n    const { connected, value, sdk } = this.state;\n\n    return (\n      <div className=\"App\">\n        {connected && sdk ? (\n          <div>\n            {\n              withTheme(\n                <SdkContext.Provider value={{ sdk }}>\n                <RichTextDialogsContainer>\n                  <EditorRichTextField onChange={this.handleValueChange} value={value} schema={sdk.field.schema} />\n                </RichTextDialogsContainer>\n              </SdkContext.Provider>\n              )\n            }\n          </div>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}